
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3D Trajectories &#8212; MRI-nufft Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/autoexamples/example_3D_trajectories';</script>
    <link rel="icon" href="../../_static/mri-nufft-icon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Animated 2D trajectories" href="example_gif_2D.html" />
    <link rel="prev" title="2D Trajectories" href="example_2D_trajectories.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/mri-nufft.png" class="logo__image only-light" alt="MRI-nufft Documentation - Home"/>
    <img src="../../_static/mri-nufft.png" class="logo__image only-dark pst-js-only" alt="MRI-nufft Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    MRI-NUFFT
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>

<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="example_2D_trajectories.html">2D Trajectories</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3D Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_gif_2D.html">Animated 2D trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_gif_3D.html">Animated 3D trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_learn_samples_multires.html">Learning sampling pattern with decimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_readme.html">Minimal example script</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_offresonance.html">Off-resonance corrected NUFFT operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_stacked.html">Stacked NUFFT operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_subspace.html">Subspace NUFFT Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_display_config.html">Trajectory display configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_trajectory_tools.html">Trajectory tools</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="GPU/index.html">GPU Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_density.html">Density Compensation Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_learn_samples.html">Learn Sampling pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_learn_samples_multicoil.html">Learn Sampling pattern for multi-coil MRI</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_learn_straight_line_readouts.html">Learn Straight line readout pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_cg.html">Reconstruction with conjugate gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_fastMRI_UNet.html">Simple UNet model.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explanations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../nufft.html">The NUFFT Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory_gradspec.html">The trajectory binary file specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mrinufft_convention.html">MRI-NUFFT Interfaces Convention</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.operators</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.autodiff.html"><code class="docutils literal notranslate"><span class="pre">operators.autodiff</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.autodiff.MRINufftAutoGrad.html">MRINufftAutoGrad</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.html"><code class="docutils literal notranslate"><span class="pre">operators.base</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.check_backend.html">check_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.get_operator.html">get_operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.list_backends.html">list_backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.FourierOperatorBase.html">FourierOperatorBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.FourierOperatorCPU.html">FourierOperatorCPU</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.html"><code class="docutils literal notranslate"><span class="pre">operators.interfaces</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.bart.html"><code class="docutils literal notranslate"><span class="pre">interfaces.bart</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.bart.MRIBartNUFFT.html">MRIBartNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.bart.RawBartNUFFT.html">RawBartNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.cufinufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.cufinufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.cufinufft.MRICufiNUFFT.html">MRICufiNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.cufinufft.RawCufinufftPlan.html">RawCufinufftPlan</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.finufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.finufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.finufft.MRIfinufft.html">MRIfinufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.finufft.RawFinufftPlan.html">RawFinufftPlan</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.gpunufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.make_pinned_smaps.html">make_pinned_smaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.MRIGpuNUFFT.html">MRIGpuNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.RawGpuNUFFT.html">RawGpuNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.nfft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.get_fourier_matrix.html">get_fourier_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.MRInfft.html">MRInfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.RawPyNFFT.html">RawPyNFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.html"><code class="docutils literal notranslate"><span class="pre">interfaces.nudft_numpy</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.get_fourier_matrix.html">get_fourier_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.get_implicit_matrix.html">get_implicit_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.implicit_type1_ndft.html">implicit_type1_ndft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.implicit_type2_ndft.html">implicit_type2_ndft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.MRInumpy.html">MRInumpy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.RawNDFT.html">RawNDFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.html"><code class="docutils literal notranslate"><span class="pre">interfaces.pynufft_cpu</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.MRIPynufft.html">MRIPynufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.RawPyNUFFT.html">RawPyNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.sigpy.html"><code class="docutils literal notranslate"><span class="pre">interfaces.sigpy</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.sigpy.MRISigpyNUFFT.html">MRISigpyNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.sigpy.RawSigpyNUFFT.html">RawSigpyNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.tfnufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.tfnufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.tfnufft.MRITensorflowNUFFT.html">MRITensorflowNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.torchkbnufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.MRITorchKbNufft.html">MRITorchKbNufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.TorchKbNUFFTcpu.html">TorchKbNUFFTcpu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.TorchKbNUFFTgpu.html">TorchKbNUFFTgpu</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.utils.html"><code class="docutils literal notranslate"><span class="pre">interfaces.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.utils.gpu_utils.html"><code class="docutils literal notranslate"><span class="pre">utils.gpu_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.utils.utils.html"><code class="docutils literal notranslate"><span class="pre">utils.utils</span></code></a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.off_resonance.html"><code class="docutils literal notranslate"><span class="pre">operators.off_resonance</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.off_resonance.get_interpolators_from_fieldmap.html">get_interpolators_from_fieldmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.off_resonance.MRIFourierCorrected.html">MRIFourierCorrected</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.html"><code class="docutils literal notranslate"><span class="pre">operators.stacked</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.stacked2traj3d.html">stacked2traj3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.traj3d2stacked.html">traj3d2stacked</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.MRIStackedNUFFT.html">MRIStackedNUFFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.MRIStackedNUFFTGPU.html">MRIStackedNUFFTGPU</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.subspace.html"><code class="docutils literal notranslate"><span class="pre">operators.subspace</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.subspace.MRISubspace.html">MRISubspace</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.trajectories</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.html"><code class="docutils literal notranslate"><span class="pre">trajectories.display</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_2D_trajectory.html">display_2D_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_3D_trajectory.html">display_3D_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_gradients.html">display_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_gradients_simply.html">display_gradients_simply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.displayConfig.html">displayConfig</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.gradients.html"><code class="docutils literal notranslate"><span class="pre">trajectories.gradients</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.gradients.patch_center_anomaly.html">patch_center_anomaly</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.html"><code class="docutils literal notranslate"><span class="pre">trajectories.maths</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.R2D.html">R2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Ra.html">Ra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Rv.html">Rv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Rx.html">Rx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Ry.html">Ry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Rz.html">Rz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.compute_coprime_factors.html">compute_coprime_factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.generate_fibonacci_circle.html">generate_fibonacci_circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.generate_fibonacci_lattice.html">generate_fibonacci_lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.generate_fibonacci_sphere.html">generate_fibonacci_sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.get_closest_fibonacci_number.html">get_closest_fibonacci_number</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.is_from_fibonacci_sequence.html">is_from_fibonacci_sequence</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.html"><code class="docutils literal notranslate"><span class="pre">trajectories.tools</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.conify.html">conify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.duplicate_along_axes.html">duplicate_along_axes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.epify.html">epify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.precess.html">precess</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.prewind.html">prewind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.radialize_center.html">radialize_center</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.rewind.html">rewind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.rotate.html">rotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.shellify.html">shellify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.stack.html">stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.stack_spherically.html">stack_spherically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.unepify.html">unepify</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.html"><code class="docutils literal notranslate"><span class="pre">trajectories.trajectory2D</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_cones.html">initialize_2D_cones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_fibonacci_spiral.html">initialize_2D_fibonacci_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_lissajous.html">initialize_2D_lissajous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_polar_lissajous.html">initialize_2D_polar_lissajous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_propeller.html">initialize_2D_propeller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_radial.html">initialize_2D_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_rings.html">initialize_2D_rings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_rosette.html">initialize_2D_rosette</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_sinusoide.html">initialize_2D_sinusoide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_spiral.html">initialize_2D_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_waves.html">initialize_2D_waves</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.html"><code class="docutils literal notranslate"><span class="pre">trajectories.trajectory3D</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_annular_shells.html">initialize_3D_annular_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_cones.html">initialize_3D_cones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_floret.html">initialize_3D_floret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_golden_means_radial.html">initialize_3D_golden_means_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_helical_shells.html">initialize_3D_helical_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_park_radial.html">initialize_3D_park_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_phyllotaxis_radial.html">initialize_3D_phyllotaxis_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_repi.html">initialize_3D_repi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_seiffert_shells.html">initialize_3D_seiffert_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_seiffert_spiral.html">initialize_3D_seiffert_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_turbine.html">initialize_3D_turbine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_wave_caipi.html">initialize_3D_wave_caipi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_wong_radial.html">initialize_3D_wong_radial</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.html"><code class="docutils literal notranslate"><span class="pre">trajectories.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.check_hardware_constraints.html">check_hardware_constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.compute_gradients_and_slew_rates.html">compute_gradients_and_slew_rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_gradients_to_slew_rates.html">convert_gradients_to_slew_rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_gradients_to_trajectory.html">convert_gradients_to_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_slew_rates_to_gradients.html">convert_slew_rates_to_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_trajectory_to_gradients.html">convert_trajectory_to_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.initialize_algebraic_spiral.html">initialize_algebraic_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.initialize_shape_norm.html">initialize_shape_norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.initialize_tilt.html">initialize_tilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.normalize_trajectory.html">normalize_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.unnormalize_trajectory.html">unnormalize_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.CaseInsensitiveEnumMeta.html">CaseInsensitiveEnumMeta</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.FloatEnum.html">FloatEnum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Gammas.html">Gammas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.NormShapes.html">NormShapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Packings.html">Packings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Spirals.html">Spirals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Tilts.html">Tilts</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.density</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.html"><code class="docutils literal notranslate"><span class="pre">density.geometry_based</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.cell_count.html">cell_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.voronoi.html">voronoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.voronoi_unique.html">voronoi_unique</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.nufft_based.html"><code class="docutils literal notranslate"><span class="pre">density.nufft_based</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.nufft_based.pipe.html">pipe</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.html"><code class="docutils literal notranslate"><span class="pre">density.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.flat_traj.html">flat_traj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.get_density.html">get_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.normalize_weights.html">normalize_weights</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.io</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.cfl.html"><code class="docutils literal notranslate"><span class="pre">io.cfl</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.cfl.cfl2traj.html">cfl2traj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.cfl.traj2cfl.html">traj2cfl</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.html"><code class="docutils literal notranslate"><span class="pre">io.nsp</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.read_arbgrad_rawdat.html">read_arbgrad_rawdat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.read_trajectory.html">read_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.write_gradients.html">write_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.write_trajectory.html">write_trajectory</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.siemens.html"><code class="docutils literal notranslate"><span class="pre">io.siemens</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.siemens.read_siemens_rawdat.html">read_siemens_rawdat</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.utils.html"><code class="docutils literal notranslate"><span class="pre">io.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.utils.add_phase_to_kspace_with_shifts.html">add_phase_to_kspace_with_shifts</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.extras</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.data.html"><code class="docutils literal notranslate"><span class="pre">extras.data</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.data.get_brainweb_map.html">get_brainweb_map</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.field_map.html"><code class="docutils literal notranslate"><span class="pre">extras.field_map</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.field_map.make_b0map.html">make_b0map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.field_map.make_t2smap.html">make_t2smap</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.gradient.html"><code class="docutils literal notranslate"><span class="pre">extras.gradient</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.gradient.cg.html">cg</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.sim.html"><code class="docutils literal notranslate"><span class="pre">extras.sim</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.sim.fse_simulation.html">fse_simulation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.smaps.html"><code class="docutils literal notranslate"><span class="pre">extras.smaps</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.smaps.low_frequency.html">low_frequency</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.utils.html"><code class="docutils literal notranslate"><span class="pre">extras.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.utils.get_smaps.html">get_smaps</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft._utils.html"><code class="docutils literal notranslate"><span class="pre">mrinufft._utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.auto_cast.html">auto_cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.get_array_module.html">get_array_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.power_method.html">power_method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.proper_trajectory.html">proper_trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.MethodRegister.html">MethodRegister</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellanneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../misc/contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/development.html">Developing MRI-nufft</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Related Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://cea-cosmic.github.io/pysap">PySAP</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cea-cosmic.github.io/ModOpt/">ModOpt</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/paquiteau/brainweb-dl">Brainweb-dl</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft/edit/main/generated/autoexamples/example_3D_trajectories.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft/issues/new?title=Issue%20on%20page%20%2Fgenerated/autoexamples/example_3D_trajectories.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/generated/autoexamples/example_3D_trajectories.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3D Trajectories</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#script-options">Script options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#radial-trajectories">Radial trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyllotaxis-radial">Phyllotaxis radial</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nc-int"><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ns-int"><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#in-out-bool"><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#golden-means-radial">Golden means radial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wong-radial">Wong radial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#park-radial">Park radial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#freeform-trajectories">Freeform trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-cones">3D Cones</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tilt-str-float"><code class="docutils literal notranslate"><span class="pre">tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-zigzags-float"><code class="docutils literal notranslate"><span class="pre">nb_zigzags</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiral-str-float"><code class="docutils literal notranslate"><span class="pre">spiral</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#width-float"><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#floret">FLORET</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-tuple"><code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">(tuple)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wave-caipi">Wave-CAIPI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-revolutions-float"><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#packing-str"><code class="docutils literal notranslate"><span class="pre">packing</span> <span class="pre">(str)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shape-str-float"><code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spacing-tuple-int-int"><code class="docutils literal notranslate"><span class="pre">spacing</span> <span class="pre">(tuple(int,</span> <span class="pre">int))</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seiffert-spirals-yarnball">Seiffert spirals / Yarnball</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-index-float"><code class="docutils literal notranslate"><span class="pre">curve_index</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axis-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">axis_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiral-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">spiral_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shell-trajectories">Shell trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helical-shells">Helical shells</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-shells-int"><code class="docutils literal notranslate"><span class="pre">nb_shells</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiral-reduction-float"><code class="docutils literal notranslate"><span class="pre">spiral_reduction</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shell-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">shell_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shot-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">shot_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annular-shells">Annular shells</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ring-tilt-float"><code class="docutils literal notranslate"><span class="pre">ring_tilt</span> <span class="pre">(float)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seiffert-shells">Seiffert shells</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fmri-trajectories">fMRI trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#turbine">TURBINE</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ns-transitions-int"><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-blades-int"><code class="docutils literal notranslate"><span class="pre">nb_blades</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#blade-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">blade_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-trains-int"><code class="docutils literal notranslate"><span class="pre">nb_trains</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#skip-factor-int"><code class="docutils literal notranslate"><span class="pre">skip_factor</span> <span class="pre">(int)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#repi">REPI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-blade-revolutions-float"><code class="docutils literal notranslate"><span class="pre">nb_blade_revolutions</span> <span class="pre">(float)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-generated-autoexamples-example-3d-trajectories-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="d-trajectories">
<span id="sphx-glr-generated-autoexamples-example-3d-trajectories-py"></span><h1>3D Trajectories<a class="headerlink" href="#d-trajectories" title="Link to this heading">#</a></h1>
<p>A collection of 3D non-Cartesian trajectories with analytical definitions.</p>
<p>Hereafter we detail and illustrate the different arguments used in the
parameterization of 3D non-Cartesian trajectories. Since most arguments
are redundant across the different patterns, some of the documentation
will refer to previous patterns for explanation.</p>
<p>Note that the examples hereafter only cover natively 3D trajectories
or famous 3D trajectories obtained from 2D. Examples on how to use
tools to make 3D trajectories out of 2D ones are presented in
<a class="reference internal" href="example_trajectory_tools.html#sphx-glr-generated-autoexamples-example-trajectory-tools-py"><span class="std std-ref">Trajectory tools</span></a></p>
<p>In this page in particular, we invite the user to manually run the script
to be able to manipulate the plot orientations with the matplotlib interface
to better visualize the 3D volumes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># External</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">show_argument</span><span class="p">,</span> <span class="n">show_trajectory</span>

<span class="c1"># Internal</span>
<span class="kn">import</span> <span class="nn">mrinufft</span> <span class="k">as</span> <span class="nn">mn</span>
<span class="kn">from</span> <span class="nn">mrinufft</span> <span class="kn">import</span> <span class="n">display_2D_trajectory</span><span class="p">,</span> <span class="n">display_3D_trajectory</span>
</pre></div>
</div>
<section id="script-options">
<h2>Script options<a class="headerlink" href="#script-options" title="Link to this heading">#</a></h2>
<p>These options are used in the examples below as default values for all trajectories.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Trajectory parameters</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">=</span> <span class="mi">120</span>  <span class="c1"># Number of shots</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># Number of samples per shot</span>
<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Choose between in-out or center-out trajectories</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tilt</span></a> <span class="o">=</span> <span class="s2">&quot;uniform&quot;</span>  <span class="c1"># Angular distance between shots</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Number of stacks, rotations, cones, shells etc.</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Number of revolutions for base trajectories</span>

<span class="c1"># Display parameters</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Figure size for trajectory plots</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Figure size for subplots</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>  <span class="c1"># Highlight one shot in particular</span>
</pre></div>
</div>
</section>
<section id="radial-trajectories">
<h2>Radial trajectories<a class="headerlink" href="#radial-trajectories" title="Link to this heading">#</a></h2>
<p>In this section are presented trajectories based on radial
lines oriented using different methods and structures.</p>
<section id="phyllotaxis-radial">
<h3>Phyllotaxis radial<a class="headerlink" href="#phyllotaxis-radial" title="Link to this heading">#</a></h3>
<p>A 3D radial pattern with phyllotactic structure.</p>
<p>The radial shots are oriented according to a Fibonacci sphere
lattice, supposed to reproduce the phyllotaxis found in nature
through flowers, etc. It ensures an almost uniform distribution.</p>
<p>This function reproduces the proposition from <a class="reference internal" href="#pic-11" id="id1"><span>[Pic+11]</span></a>, but the name
spiral phyllotaxis was changed to avoid confusion with
actual spirals.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward
the center then outside (in-out) or not (center-out). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_phyllotaxis_radial</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_001.png" srcset="../../_images/sphx_glr_example_3D_trajectories_001.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="nc-int">
<h4><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code><a class="headerlink" href="#nc-int" title="Link to this heading">#</a></h4>
<p>The number of individual shots, here 3D radial lines, used to cover the
k-space. More shots means better coverage but also longer acquisitions.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_phyllotaxis_radial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_002.png" srcset="../../_images/sphx_glr_example_3D_trajectories_002.png" alt="30, 60, 120, 240" class = "sphx-glr-single-img"/></section>
<section id="ns-int">
<h4><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code><a class="headerlink" href="#ns-int" title="Link to this heading">#</a></h4>
<p>The number of samples per shot. More samples means that either
the acquisition window is lengthened or the sampling rate is increased.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_phyllotaxis_radial</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_003.png" srcset="../../_images/sphx_glr_example_3D_trajectories_003.png" alt="10, 25, 40, 100" class = "sphx-glr-single-img"/></section>
<section id="in-out-bool">
<h4><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code><a class="headerlink" href="#in-out-bool" title="Link to this heading">#</a></h4>
<p>It allows switching between different ways to define how the shot should
travel through the k-space:</p>
<ul class="simple">
<li><p>in-out: starting from the outer regions, then passing through the center
then going back to outer regions, often on the opposite side (radial, cones)</p></li>
<li><p>center-out or center-center: when <code class="docutils literal notranslate"><span class="pre">in_out=False</span></code> the trajectory will start
at the center, but depending on the specific trajectory formula the path might
end up in the outer regions (radial, spiral, cones, etc)
or back to the center (rosette, lissajous).</p></li>
</ul>
<p>Note that the behavior of both <code class="docutils literal notranslate"><span class="pre">tilt</span></code> and <code class="docutils literal notranslate"><span class="pre">width</span></code> are automatically adapted
to the changes to avoid having to update them too when switching <code class="docutils literal notranslate"><span class="pre">in_out</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_phyllotaxis_radial</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_004.png" srcset="../../_images/sphx_glr_example_3D_trajectories_004.png" alt="True, False" class = "sphx-glr-single-img"/></section>
</section>
<section id="golden-means-radial">
<h3>Golden means radial<a class="headerlink" href="#golden-means-radial" title="Link to this heading">#</a></h3>
<p>A 3D radial pattern with golden means-based structure.</p>
<p>The radial shots are oriented using multidimensional golden means,
which are derived from modified Fibonacci sequences by an eigenvalue
approach, to provide a temporally stable acquisition with widely
spread shots at all time.</p>
<p>This function reproduces the proposition from <a class="reference internal" href="#cha-09" id="id2"><span>[Cha+09]</span></a>, with
in addition the option to switch between center-out
and in-out radial shots.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward
the center then outside (in-out) or not (center-out).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code>. See 3D radial</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_golden_means_radial</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_005.png" srcset="../../_images/sphx_glr_example_3D_trajectories_005.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/></section>
<section id="wong-radial">
<h3>Wong radial<a class="headerlink" href="#wong-radial" title="Link to this heading">#</a></h3>
<p>A 3D radial pattern with a spiral structure.</p>
<p>The radial shots are oriented according to an archimedean spiral
over a sphere surface, for each interleave.</p>
<p>This function reproduces the proposition from <a class="reference internal" href="#wr94" id="id3"><span>[WR94]</span></a>, with
in addition the option to switch between center-out
and in-out radial shots.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_interleaves</span> <span class="pre">(int)</span></code>: number of implicit interleaves
defining the shots order for a more structured k-space
distribution over time. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward
the center then outside (in-out) or not (center-out).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code>. See 3D radial</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_wong_radial</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_006.png" srcset="../../_images/sphx_glr_example_3D_trajectories_006.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/></section>
<section id="park-radial">
<h3>Park radial<a class="headerlink" href="#park-radial" title="Link to this heading">#</a></h3>
<p>A 3D radial pattern with a spiral structure.</p>
<p>The radial shots are oriented according to an archimedean spiral
over a sphere surface, shared uniformly between all interleaves.</p>
<p>This function reproduces the proposition from <a class="reference internal" href="#par-16" id="id4"><span>[Par+16]</span></a>,
itself based on the work from <a class="reference internal" href="#wr94" id="id5"><span>[WR94]</span></a>, with
in addition the option to switch between center-out
and in-out radial shots.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_interleaves</span> <span class="pre">(int)</span></code>: number of implicit interleaves
defining the shots order for a more structured k-space
distribution over time. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward
the center then outside (in-out) or not (center-out).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code>. See 3D radial</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_park_radial</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_007.png" srcset="../../_images/sphx_glr_example_3D_trajectories_007.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/></section>
</section>
<section id="freeform-trajectories">
<h2>Freeform trajectories<a class="headerlink" href="#freeform-trajectories" title="Link to this heading">#</a></h2>
<p>In this section are presented trajectories in all kinds of shapes
and relying on different principles.</p>
<section id="d-cones">
<h3>3D Cones<a class="headerlink" href="#d-cones" title="Link to this heading">#</a></h3>
<p>A common pattern composed of 3D cones oriented all over within a sphere.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive shot (in radians).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;golden&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward
the center then outside (in-out) or not (center-out).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code>. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_zigzags</span> <span class="pre">(float)</span></code>: number of revolutions over a center-out shot.
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">5)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spiral</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: type of spiral defined through the general
archimedean equation. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;archimedes&quot;)</span></code>. See 2D spiral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code>: cone width factor, normalized to densely cover the k-space
by default. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_cones</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_008.png" srcset="../../_images/sphx_glr_example_3D_trajectories_008.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="tilt-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#tilt-str-float" title="Link to this heading">#</a></h4>
<p>The angle between each consecutive shots, either in radians or as a
string defining some default mods such as uniform for
<span class="math notranslate nohighlight">\(2 \pi / N_c\)</span>, or golden and mri golden for the different
common definitions of golden angles. The angle is automatically adapted
when the <code class="docutils literal notranslate"><span class="pre">in_out</span></code> argument is switched to keep the same behavior.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="s2">&quot;golden&quot;</span><span class="p">,</span> <span class="s2">&quot;mri-golden&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">17</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_cones</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tilt</span></a><span class="o">=</span><span class="n">x</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_009.png" srcset="../../_images/sphx_glr_example_3D_trajectories_009.png" alt="uniform, golden, mri-golden, 0.18479956785822313" class = "sphx-glr-single-img"/></section>
<section id="nb-zigzags-float">
<h4><code class="docutils literal notranslate"><span class="pre">nb_zigzags</span> <span class="pre">(float)</span></code><a class="headerlink" href="#nb-zigzags-float" title="Link to this heading">#</a></h4>
<p>The number of zigzags, or revolutions around the 3D cone on a center-out shot
(doubled overall for in-out trajectories)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_cones</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <span class="n">nb_zigzags</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_010.png" srcset="../../_images/sphx_glr_example_3D_trajectories_010.png" alt="0.5, 2, 5, 10" class = "sphx-glr-single-img"/></section>
<section id="spiral-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">spiral</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#spiral-str-float" title="Link to this heading">#</a></h4>
<p>The shape of the spiral defined and documented in
<code class="docutils literal notranslate"><span class="pre">initialize_2D_spiral</span></code>. Both <code class="docutils literal notranslate"><span class="pre">&quot;archimedes&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;fermat&quot;</span></code>
spirals are available as string options for convenience.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;archimedes&quot;</span><span class="p">,</span> <span class="s2">&quot;fermat&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_cones</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <span class="n">spiral</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_011.png" srcset="../../_images/sphx_glr_example_3D_trajectories_011.png" alt="archimedes, fermat, 0.5, 1.5" class = "sphx-glr-single-img"/></section>
<section id="width-float">
<h4><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code><a class="headerlink" href="#width-float" title="Link to this heading">#</a></h4>
<p>The cone width normalized such that <code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">=</span> <span class="pre">1</span></code> corresponds to
non-overlapping cones covering the whole k-space sphere, and
therefore <code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">&gt;</span> <span class="pre">1</span></code> creates overlap between cone regions and
<code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> tends to more radial patterns.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_cones</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_012.png" srcset="../../_images/sphx_glr_example_3D_trajectories_012.png" alt="0.2, 1, 2, 3" class = "sphx-glr-single-img"/></section>
</section>
<section id="floret">
<h3>FLORET<a class="headerlink" href="#floret" title="Link to this heading">#</a></h3>
<p>A pattern introduced in <a class="reference internal" href="example_trajectory_tools.html#pip-11" id="id6"><span>[Pip+11]</span></a> composed of Fermat spirals
folded into cones. The acronym stands for Fermat Looped, Orthogonally
Encoded Trajectories. Most arguments are related either to
<code class="docutils literal notranslate"><span class="pre">initialize_2D_spiral</span></code> or to <code class="docutils literal notranslate"><span class="pre">tools.conify</span></code>.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward
the center then outside (in-out) or not (center-out).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code>. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code>: number of revolutions performed from the
center. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code>. See 2D spiral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spiral</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: type of spiral defined through the general
archimedean equation. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;fermat&quot;)</span></code>. See 2D spiral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cone_tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive cones
around the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;golden&quot;)</span></code>. See <code class="docutils literal notranslate"><span class="pre">tools.conify</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_angle</span> <span class="pre">(float)</span></code>: maximum angle of the cones. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">2)</span></code>.
See <code class="docutils literal notranslate"><span class="pre">tools.conify</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">(tuple)</span></code>: axes over which cones are created, by default (2,)</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_floret</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="p">,</span>
    <span class="n">max_angle</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_013.png" srcset="../../_images/sphx_glr_example_3D_trajectories_013.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="axes-tuple">
<h4><code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">(tuple)</span></code><a class="headerlink" href="#axes-tuple" title="Link to this heading">#</a></h4>
<p>Indices of the different axes over which cones are created,
with 0, 1, 2 corresponding to <span class="math notranslate nohighlight">\(k_x, k_y, k_z\)</span> respectively.
The <code class="docutils literal notranslate"><span class="pre">Nc</span></code> shots and <code class="docutils literal notranslate"><span class="pre">nb_cones</span></code> are distributed
over all axes, and therefore should be divisible by <code class="docutils literal notranslate"><span class="pre">len(axes)</span></code>.</p>
<p>The point is to provide an efficient coverage by reducing <code class="docutils literal notranslate"><span class="pre">max_angle</span></code>
to avoid redundancy around one axis, but still cover the whole
k-space sphere by duplicating cones along several axes, as initially
proposed by <a class="reference internal" href="example_trajectory_tools.html#pip-11" id="id7"><span>[Pip+11]</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_floret</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="p">,</span>
    <span class="n">max_angle</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_014.png" srcset="../../_images/sphx_glr_example_3D_trajectories_014.png" alt="(0,), (1,), (0, 1), (0, 1, 2)" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_015.png" srcset="../../_images/sphx_glr_example_3D_trajectories_015.png" alt="(0,), (1,), (0, 1), (0, 1, 2)" class = "sphx-glr-single-img"/></section>
</section>
<section id="wave-caipi">
<h3>Wave-CAIPI<a class="headerlink" href="#wave-caipi" title="Link to this heading">#</a></h3>
<p>A pattern introduced in <a class="reference internal" href="#bil-15" id="id8"><span>[Bil+15]</span></a> composed of helices evolving
in the same direction and packed together,
inherited from trajectories such as CAIPIRINHA and
Bunched Phase-Encoding (BPE) designed to better spread aliasing
and facilitate reconstruction.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: number of revolution of the helices.
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">5)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code>: helix width factor, normalized to densely
cover the k-space by default. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">packing</span> <span class="pre">(str)</span></code>: packing method used to position the helices.
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;triangular&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: shape over the 2D kx-ky plane to pack with shots.
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;circle&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span> <span class="pre">(tuple(int,</span> <span class="pre">int))</span></code>: Spacing between helices over the
2D <span class="math notranslate nohighlight">\(k_x\)</span>-<span class="math notranslate nohighlight">\(k_y\)</span> plane normalized similarly to <cite>width</cite>. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">(1,</span> <span class="pre">1))</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_wave_caipi</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_016.png" srcset="../../_images/sphx_glr_example_3D_trajectories_016.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="nb-revolutions-float">
<h4><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code><a class="headerlink" href="#nb-revolutions-float" title="Link to this heading">#</a></h4>
<p>The number of revolutions of the helices from bottom to top.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_wave_caipi</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_017.png" srcset="../../_images/sphx_glr_example_3D_trajectories_017.png" alt="0.5, 2.5, 5, 10" class = "sphx-glr-single-img"/></section>
<section id="id9">
<h4><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code><a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>The helix diameter normalized such that <code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">=</span> <span class="pre">1</span></code> corresponds to
non-overlapping shots densely covering the k-space shape (for square packing),
and therefore <code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">&gt;</span> <span class="pre">1</span></code> creates overlap between cone regions and
<code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> tends to more radial patterns.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">packing</span></code> for more details about coverage.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_wave_caipi</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_018.png" srcset="../../_images/sphx_glr_example_3D_trajectories_018.png" alt="0.2, 1, 2, 3" class = "sphx-glr-single-img"/></section>
<section id="packing-str">
<h4><code class="docutils literal notranslate"><span class="pre">packing</span> <span class="pre">(str)</span></code><a class="headerlink" href="#packing-str" title="Link to this heading">#</a></h4>
<p>The method used to pack circles of same size within an arbitrary <code class="docutils literal notranslate"><span class="pre">shape</span></code>.
The available methods are <code class="docutils literal notranslate"><span class="pre">&quot;triangular&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;square&quot;</span></code> for regular tiling
over dense grids, and <code class="docutils literal notranslate"><span class="pre">&quot;circular&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> for
irregular packing.
Different aliases are available, such as <code class="docutils literal notranslate"><span class="pre">&quot;triangle&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;hexagon&quot;</span></code> instead
of <code class="docutils literal notranslate"><span class="pre">&quot;triangular&quot;</span></code>.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">&quot;triangular&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> packings have slightly overlapping
helices, as their widths correspond to that of an optimaly packed
triangular/hexagonal grid.
The <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> packing also naturally overlaps as the positions are determined
following a uniform distribution over <span class="math notranslate nohighlight">\(k_x\)</span> and <span class="math notranslate nohighlight">\(k_y\)</span> dimensions.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;triangular&quot;</span><span class="p">,</span> <span class="s2">&quot;square&quot;</span><span class="p">,</span> <span class="s2">&quot;circular&quot;</span><span class="p">,</span> <span class="s2">&quot;fibonacci&quot;</span><span class="p">,</span> <span class="s2">&quot;random&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_wave_caipi</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">packing</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_019.png" srcset="../../_images/sphx_glr_example_3D_trajectories_019.png" alt="triangular, square, circular, fibonacci, random" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_020.png" srcset="../../_images/sphx_glr_example_3D_trajectories_020.png" alt="triangular, square, circular, fibonacci, random" class = "sphx-glr-single-img"/></section>
<section id="shape-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#shape-str-float" title="Link to this heading">#</a></h4>
<p>The 2D shape defined over the <span class="math notranslate nohighlight">\(k_x\)</span>-<span class="math notranslate nohighlight">\(k_y\)</span> plane
and where the helices should be packed. Aliases are available for convenience,
namely <code class="docutils literal notranslate"><span class="pre">&quot;circle&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;square&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;diamond&quot;</span></code>, but shapes are primarily
defined through the p-norm of the 2D coordinates following the convention
of the <code class="docutils literal notranslate"><span class="pre">ord</span></code> parameter from <code class="docutils literal notranslate"><span class="pre">numpy.linalg.norm</span></code>.</p>
<p>The shapes are approximately respected depending on the available <code class="docutils literal notranslate"><span class="pre">Nc</span></code>
parameter, and extra shots on the edges will be placed in priority to have
a minimal 2-norm (eliminating the diagonals) except for circles with infinity-norm
(accumulating over the diagonals).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="s2">&quot;square&quot;</span><span class="p">,</span> <span class="s2">&quot;diamond&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_wave_caipi</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_021.png" srcset="../../_images/sphx_glr_example_3D_trajectories_021.png" alt="circle, square, diamond, 0.5" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_022.png" srcset="../../_images/sphx_glr_example_3D_trajectories_022.png" alt="circle, square, diamond, 0.5" class = "sphx-glr-single-img"/></section>
<section id="spacing-tuple-int-int">
<h4><code class="docutils literal notranslate"><span class="pre">spacing</span> <span class="pre">(tuple(int,</span> <span class="pre">int))</span></code><a class="headerlink" href="#spacing-tuple-int-int" title="Link to this heading">#</a></h4>
<p>The spacing between helices over the <span class="math notranslate nohighlight">\(k_x\)</span>-<span class="math notranslate nohighlight">\(k_y\)</span> plane, mostly
defined for <code class="docutils literal notranslate"><span class="pre">&quot;square&quot;</span></code> packing. It is defined to correspond to the <code class="docutils literal notranslate"><span class="pre">width</span></code>
unit, itself automatically matching the helix diameters, which can cause more
complex behaviors for other packing methods as the diameters are normalized to
fit within the cubic k-space.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">)]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_wave_caipi</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">packing</span><span class="o">=</span><span class="s2">&quot;square&quot;</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_023.png" srcset="../../_images/sphx_glr_example_3D_trajectories_023.png" alt="(1, 1), (2, 1), (1, 2), (2.3, 1.8)" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_024.png" srcset="../../_images/sphx_glr_example_3D_trajectories_024.png" alt="(1, 1), (2, 1), (1, 2), (2.3, 1.8)" class = "sphx-glr-single-img"/></section>
</section>
<section id="seiffert-spirals-yarnball">
<h3>Seiffert spirals / Yarnball<a class="headerlink" href="#seiffert-spirals-yarnball" title="Link to this heading">#</a></h3>
<p>A recent pattern with tightly controlled gradient norms using radially
modulated Seiffert spirals, based on Jacobi elliptic functions.
Note that Seiffert spirals more commonly refer to a curve evolving
over a sphere surface rather than a volume, with the advantage of
having a constant speed and angular velocity. The MR trajectory
is obtained by increasing progressively the radius of the sphere.</p>
<p>This implementation follows the proposition from <a class="reference internal" href="#smr18" id="id10"><span>[SMR18]</span></a> based on
works from <a class="reference internal" href="#er00" id="id11"><span>[Er00]</span></a> and <a class="reference internal" href="#br09" id="id12"><span>[Br09]</span></a>. The pattern is also referred to as
Yarnball by a different team <a class="reference internal" href="#sb21" id="id13"><span>[SB21]</span></a>, as a nod to the Yarn trajectory
pictured in <a class="reference internal" href="#in95" id="id14"><span>[IN95]</span></a>, even though both admittedly share little in common.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curve_index</span> <span class="pre">(float)</span></code>: Index controlling curvature from 0 (flat) to 1 (curvy).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">0.3)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code>: number of revolutions or elliptic periods.
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive shot (in radians)
while descending over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;golden&quot;)</span></code>. See 3D cones</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spiral_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle of the spiral within its own axis,
defined from center to its outermost point <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;golden&quot;)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward the center
then outside (in-out) or not (center-out). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code>. See 3D radial</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_seiffert_spiral</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_025.png" srcset="../../_images/sphx_glr_example_3D_trajectories_025.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="curve-index-float">
<h4><code class="docutils literal notranslate"><span class="pre">curve_index</span> <span class="pre">(float)</span></code><a class="headerlink" href="#curve-index-float" title="Link to this heading">#</a></h4>
<p>An index defined over <span class="math notranslate nohighlight">\([0, 1)\)</span> controling the curvature, with <span class="math notranslate nohighlight">\(0\)</span>
corresponding to a planar spiral, and increasing the length and exploration of
the curve while asymptotically approaching <span class="math notranslate nohighlight">\(1\)</span>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_seiffert_spiral</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <span class="n">curve_index</span><span class="o">=</span><span class="n">x</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_026.png" srcset="../../_images/sphx_glr_example_3D_trajectories_026.png" alt="0, 0.3, 0.9, 0.99" class = "sphx-glr-single-img"/></section>
<section id="id15">
<h4><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code><a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<p>Number of revolutions, or simply the number of times a curve reaches its
original orientation. For regular Seiffert spirals, it corresponds to the
number of times the shot reaches the starting pole of the sphere. It
subsequently defines the length of the curve.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_seiffert_spiral</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_027.png" srcset="../../_images/sphx_glr_example_3D_trajectories_027.png" alt="0, 0.5, 1, 2" class = "sphx-glr-single-img"/></section>
<section id="axis-tilt-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">axis_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#axis-tilt-str-float" title="Link to this heading">#</a></h4>
<p>Angle between consecutive shots while descending along the <span class="math notranslate nohighlight">\(k_z\)</span>-axis.
The <code class="docutils literal notranslate"><span class="pre">&quot;golden&quot;</span></code> value chosen as default provides an almost even distribution
over the k-space sphere by relying on Fibonacci lattice, and therefore it should
be changed carefully when relevant.</p>
<p>Note that in the examples below, the <code class="docutils literal notranslate"><span class="pre">spiral_tilt</span></code> argument is set to 0
for clarity.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="s2">&quot;golden&quot;</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_seiffert_spiral</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">axis_tilt</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">spiral_tilt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_028.png" srcset="../../_images/sphx_glr_example_3D_trajectories_028.png" alt="0, uniform, golden, 1.0471975511965976" class = "sphx-glr-single-img"/></section>
<section id="spiral-tilt-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">spiral_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#spiral-tilt-str-float" title="Link to this heading">#</a></h4>
<p>Define the angle of the spiral within its own axis after precession of the spiral
along the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. Since the precession is applied through Rodrigues
coefficients and Seiffert spirals are asymetric, their orientation right after
the precession can be quite biased and yield unbalanced densities.</p>
<p>The method proposed in <a class="reference internal" href="#smr18" id="id16"><span>[SMR18]</span></a> to handle that issue is to rotate the spirals
along their own axes, but the exact way to choose the rotation is not specified.
Rather than picking random angles, we decided to provide the conventional tilt
argument.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="s2">&quot;golden&quot;</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_seiffert_spiral</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">axis_tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">spiral_tilt</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_029.png" srcset="../../_images/sphx_glr_example_3D_trajectories_029.png" alt="0, uniform, golden, 1.0471975511965976" class = "sphx-glr-single-img"/></section>
</section>
</section>
<section id="shell-trajectories">
<h2>Shell trajectories<a class="headerlink" href="#shell-trajectories" title="Link to this heading">#</a></h2>
<p>In this section are presented trajectories that are composed of concentric
shells, i.e. shots arranged over spherical surfaces.</p>
<section id="helical-shells">
<h3>Helical shells<a class="headerlink" href="#helical-shells" title="Link to this heading">#</a></h3>
<p>An arrangement of spirals covering sphere surfaces, often referred to as
concentric shells. Here the name was changed to avoid confusion with
other trajectories sharing this principle.</p>
<p>This implementation follows the proposition from <a class="reference internal" href="#yrb06" id="id17"><span>[YRB06]</span></a> but the idea
is much older and can be traced back at least to <a class="reference internal" href="#in95" id="id18"><span>[IN95]</span></a>.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_shells</span> <span class="pre">(int)</span></code>: number of shells used to partition the k-space.
It should be lower than or equal to <code class="docutils literal notranslate"><span class="pre">Nc</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spiral_reduction</span> <span class="pre">(float)</span></code>: factor to reduce the automatic number of
spiral revolution per shot. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shell_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive shell (in radians).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;intergaps&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shot_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive shot
over a sphere (in radians). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;uniform&quot;)</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_helical_shells</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_030.png" srcset="../../_images/sphx_glr_example_3D_trajectories_030.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="nb-shells-int">
<h4><code class="docutils literal notranslate"><span class="pre">nb_shells</span> <span class="pre">(int)</span></code><a class="headerlink" href="#nb-shells-int" title="Link to this heading">#</a></h4>
<p>Number of shells, i.e. concentric spheres, used to partition the k-space sphere.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_helical_shells</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><span class="n">x</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">spiral_reduction</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_031.png" srcset="../../_images/sphx_glr_example_3D_trajectories_031.png" alt="1, 2, 3, 6" class = "sphx-glr-single-img"/></section>
<section id="spiral-reduction-float">
<h4><code class="docutils literal notranslate"><span class="pre">spiral_reduction</span> <span class="pre">(float)</span></code><a class="headerlink" href="#spiral-reduction-float" title="Link to this heading">#</a></h4>
<p>Normalized factor controlling the curvature of the spirals over the sphere surfaces.
The curvature is determined by <code class="docutils literal notranslate"><span class="pre">Nc</span></code> and <code class="docutils literal notranslate"><span class="pre">Ns</span></code> automatically based on <a class="reference internal" href="#yrb06" id="id19"><span>[YRB06]</span></a>
in order to provide a coverage with minimal aliasing, but the curve velocities and
accelerations might make them incompatible with gradient and slew rate constraints.
Therefore we provided <code class="docutils literal notranslate"><span class="pre">spiral_reduction</span></code> to reduce (or increase) the pre-determined
spiral curvature.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_helical_shells</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <span class="n">spiral_reduction</span><span class="o">=</span><span class="n">x</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_032.png" srcset="../../_images/sphx_glr_example_3D_trajectories_032.png" alt="0.5, 1, 2, 4" class = "sphx-glr-single-img"/></section>
<section id="shell-tilt-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">shell_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#shell-tilt-str-float" title="Link to this heading">#</a></h4>
<p>Angle between each consecutive shells (in radians).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="s2">&quot;intergaps&quot;</span><span class="p">,</span> <span class="s2">&quot;golden&quot;</span><span class="p">,</span> <span class="mf">3.1415</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_helical_shells</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <span class="n">spiral_reduction</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shell_tilt</span><span class="o">=</span><span class="n">x</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_033.png" srcset="../../_images/sphx_glr_example_3D_trajectories_033.png" alt="uniform, intergaps, golden, 3.1415" class = "sphx-glr-single-img"/></section>
<section id="shot-tilt-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">shot_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#shot-tilt-str-float" title="Link to this heading">#</a></h4>
<p>Angle between each consecutive shot over a shell/sphere (in radians).
Note that since the number of shots per shell is determined automatically
for each individual shell following a density provided in <a class="reference internal" href="#yrb06" id="id20"><span>[YRB06]</span></a>, it
is advised to use adaptive keywords such as uniform rather than hard values.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="s2">&quot;intergaps&quot;</span><span class="p">,</span> <span class="s2">&quot;golden&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_helical_shells</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <span class="n">spiral_reduction</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shot_tilt</span><span class="o">=</span><span class="n">x</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_034.png" srcset="../../_images/sphx_glr_example_3D_trajectories_034.png" alt="uniform, intergaps, golden, 0.1" class = "sphx-glr-single-img"/></section>
</section>
<section id="annular-shells">
<h3>Annular shells<a class="headerlink" href="#annular-shells" title="Link to this heading">#</a></h3>
<p>An exclusive trajectory composed of re-arranged rings covering
concentric shells with minimal redundancy, based on the work from <a class="reference internal" href="#hm11" id="id21"><span>[HM11]</span></a>.
The rings are cut in halves and recombined in order to provide
more homogeneous shot lengths as compared to a spherical stack
of rings.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_shells</span> <span class="pre">(int)</span></code>: number of shells used to partition the k-space.
It should be lower than or equal to <code class="docutils literal notranslate"><span class="pre">Nc</span></code>. See helical shells.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shell_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive shell (in radians).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">pi)</span></code>. See helical shells.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ring_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle used to rotate the half-sphere of rings
(in radians). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">2)</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_annular_shells</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_035.png" srcset="../../_images/sphx_glr_example_3D_trajectories_035.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="ring-tilt-float">
<h4><code class="docutils literal notranslate"><span class="pre">ring_tilt</span> <span class="pre">(float)</span></code><a class="headerlink" href="#ring-tilt-float" title="Link to this heading">#</a></h4>
<p>Angle (in radians) defining the rotation between the two halves of
each spheres, and therefore also the rings recombination. A zero angle,
as seen on the first example, results in a simple stack-of-rings, while
an angle of <span class="math notranslate nohighlight">\(\pi / 2\)</span> on the third example makes the ring take
a right angle.</p>
<p>Note that the angle is discretized over each sphere depending on the
number of rings, and therefore the angle might be inaccurate over smaller
shells.</p>
<p>An angle of <span class="math notranslate nohighlight">\(\pi / 2\)</span> allows reaching the best shot length homogeneity,
and it partitions the spheres into several connex curves composed of exactly
two shots.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_annular_shells</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <span class="n">ring_tilt</span><span class="o">=</span><span class="n">x</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_036.png" srcset="../../_images/sphx_glr_example_3D_trajectories_036.png" alt="0, 0.7853981633974483, 1.5707963267948966, 2.356194490192345" class = "sphx-glr-single-img"/></section>
</section>
<section id="seiffert-shells">
<h3>Seiffert shells<a class="headerlink" href="#seiffert-shells" title="Link to this heading">#</a></h3>
<p>An exclusive trajectory composed of re-arranged Seiffert spirals
covering concentric shells. All curves have a constant speed and
angular velocity, depending on the size of the sphere they belong to.</p>
<p>This implementation is inspired by the propositions from <a class="reference internal" href="#yrb06" id="id22"><span>[YRB06]</span></a> and <a class="reference internal" href="#smr18" id="id23"><span>[SMR18]</span></a>,
and also based on works from <a class="reference internal" href="#er00" id="id24"><span>[Er00]</span></a> and <a class="reference internal" href="#br09" id="id25"><span>[Br09]</span></a>.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code>: number of samples per shot. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curve_index</span> <span class="pre">(float)</span></code>: Index controlling curvature from 0 (flat) to 1 (curvy).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">0.3)</span></code>. See Seiffert spirals</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code>: number of revolutions or elliptic periods.
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code>.  See Seiffert spirals</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shell_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive shell (in radians).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;intergaps&quot;)</span></code>. See helical shells</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shot_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive shot
over a sphere (in radians). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;uniform&quot;)</span></code>. See helical shells</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_seiffert_shells</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_037.png" srcset="../../_images/sphx_glr_example_3D_trajectories_037.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/></section>
</section>
<section id="fmri-trajectories">
<h2>fMRI trajectories<a class="headerlink" href="#fmri-trajectories" title="Link to this heading">#</a></h2>
<p>In this section are presented long trajectories designed for
functional MRI to cover the k-space in a few shots, often composed
of multiple readouts.</p>
<section id="turbine">
<h3>TURBINE<a class="headerlink" href="#turbine" title="Link to this heading">#</a></h3>
<p>The TURBINE (Trajectory Using Radially Batched Internal Navigator Echoes)
trajectory as proposed in <a class="reference internal" href="#mgm10" id="id26"><span>[MGM10]</span></a>. It consists of EPI-like multi-echo
planes rotated around any axis (here <span class="math notranslate nohighlight">\(k_z\)</span>-axis) in a radial fashion.</p>
<p>Note that our implementation also proposes to segment the planes
into several shots instead of just one, and includes the proposition
from <a class="reference internal" href="#gmc22" id="id27"><span>[GMC22]</span></a> to also accelerate within the blades by skipping lines
but while alternating them between blades.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns_readouts</span> <span class="pre">(int)</span></code>: number of samples per readout. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code>: number of samples per transition between
two readouts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_blades</span> <span class="pre">(int)</span></code>: number of blades used to group readouts into
and partition the k-space. It should be lower than <code class="docutils literal notranslate"><span class="pre">Nc</span></code> and divide it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blade_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive blades
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis (in radians). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;uniform&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_trains</span> <span class="pre">(int)</span></code>: number of resulting shots, or readout trains,
such that each of them will be composed of <span class="math notranslate nohighlight">\(n\)</span> readouts with
<code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">=</span> <span class="pre">n</span> <span class="pre">*</span> <span class="pre">nb_trains</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> then <code class="docutils literal notranslate"><span class="pre">nb_trains</span></code> is set
to <code class="docutils literal notranslate"><span class="pre">nb_blades</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip_factor</span> <span class="pre">(int)</span></code>: factor defining the way different blades alternate
to skip lines, forming groups of <code class="docutils literal notranslate"><span class="pre">skip_factor</span></code> non-redundant blades.
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward the center
then outside (in-out) or not (center-out). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">True)</span></code>. See 3D radial</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">15</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_turbine</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_038.png" srcset="../../_images/sphx_glr_example_3D_trajectories_038.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="ns-transitions-int">
<h4><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code><a class="headerlink" href="#ns-transitions-int" title="Link to this heading">#</a></h4>
<p>Number of samples per transition between two readouts.
Smoother transitions are achieved with more points, but it means longer
waiting times between readouts if they are split during acquisition.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_turbine</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_039.png" srcset="../../_images/sphx_glr_example_3D_trajectories_039.png" alt="1, 50, 100, 200" class = "sphx-glr-single-img"/></section>
<section id="nb-blades-int">
<h4><code class="docutils literal notranslate"><span class="pre">nb_blades</span> <span class="pre">(int)</span></code><a class="headerlink" href="#nb-blades-int" title="Link to this heading">#</a></h4>
<p>Number of blades used to group readouts into
and partition the k-space. More blades means fewer lines per blade.
It should be lower than <code class="docutils literal notranslate"><span class="pre">Nc</span></code> and divide it.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">15</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">30</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_turbine</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_040.png" srcset="../../_images/sphx_glr_example_3D_trajectories_040.png" alt="24, 8, 4, 2" class = "sphx-glr-single-img"/></section>
<section id="blade-tilt-str-float">
<h4><code class="docutils literal notranslate"><span class="pre">blade_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code><a class="headerlink" href="#blade-tilt-str-float" title="Link to this heading">#</a></h4>
<p>Angle between each consecutive blades over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis (in radians)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="s2">&quot;golden&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_turbine</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span>
    <span class="n">blade_tilt</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_041.png" srcset="../../_images/sphx_glr_example_3D_trajectories_041.png" alt="uniform, golden" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_042.png" srcset="../../_images/sphx_glr_example_3D_trajectories_042.png" alt="uniform, golden" class = "sphx-glr-single-img"/></section>
<section id="nb-trains-int">
<h4><code class="docutils literal notranslate"><span class="pre">nb_trains</span> <span class="pre">(int)</span></code><a class="headerlink" href="#nb-trains-int" title="Link to this heading">#</a></h4>
<p>Number of resulting shots, or readout trains, such that each of them
will be composed of <span class="math notranslate nohighlight">\(n\)</span> readouts with <code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">=</span> <span class="pre">n</span> <span class="pre">*</span> <span class="pre">nb_trains</span></code>.
If <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> then <code class="docutils literal notranslate"><span class="pre">nb_trains</span></code> is set to <code class="docutils literal notranslate"><span class="pre">nb_blades</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span> <span class="mi">15</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_turbine</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span>
    <span class="n">nb_trains</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_043.png" srcset="../../_images/sphx_glr_example_3D_trajectories_043.png" alt="8, 24, 40, 120" class = "sphx-glr-single-img"/></section>
<section id="skip-factor-int">
<h4><code class="docutils literal notranslate"><span class="pre">skip_factor</span> <span class="pre">(int)</span></code><a class="headerlink" href="#skip-factor-int" title="Link to this heading">#</a></h4>
<p>Factor defining the way different blades alternate to skip lines,
forming groups of <code class="docutils literal notranslate"><span class="pre">skip_factor</span></code> non-redundant blades.</p>
<p>This enables the in-plane acceleration proposed by <a class="reference internal" href="#gmc22" id="id28"><span>[GMC22]</span></a> by
increasing <code class="docutils literal notranslate"><span class="pre">skip_factor</span></code> and <code class="docutils literal notranslate"><span class="pre">nb_blades</span></code> together by a same
factor. Note that using <code class="docutils literal notranslate"><span class="pre">skip_factor</span></code> superior to <code class="docutils literal notranslate"><span class="pre">nb_blades</span></code>
as below results in k-space areas being not covered by any blade.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_turbine</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span>
    <span class="n">skip_factor</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_044.png" srcset="../../_images/sphx_glr_example_3D_trajectories_044.png" alt="1, 2, 4, 10" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_045.png" srcset="../../_images/sphx_glr_example_3D_trajectories_045.png" alt="1, 2, 4, 10" class = "sphx-glr-single-img"/></section>
</section>
<section id="repi">
<h3>REPI<a class="headerlink" href="#repi" title="Link to this heading">#</a></h3>
<p>The REPI (Radial Echo Planar Imaging) trajectory proposed in <a class="reference internal" href="#rms22" id="id29"><span>[RMS22]</span></a>
and officially inspired from TURBINE proposed in <a class="reference internal" href="#mgm10" id="id30"><span>[MGM10]</span></a>.
It consists of multi-echo stacks of lines or spirals rotated around any axis
(here <span class="math notranslate nohighlight">\(k_z\)</span>-axis) in a radial fashion, but each stack is also slightly
shifted along the rotation axis in order to be entangled with the others
without redundancy. This feature is similar to choosing <code class="docutils literal notranslate"><span class="pre">skip_factor</span></code>
equal to <code class="docutils literal notranslate"><span class="pre">nb_blades</span></code> in TURBINE.</p>
<p>Note that our implementation also proposes to segment the planes/stacks
into several shots, instead of just one. Spirals can also be customized
beyond the classic Archimedean spiral.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of individual shots. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns_readouts</span> <span class="pre">(int)</span></code>: number of samples per readout. See 3D radial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code>: number of samples per transition between
two readouts. See TURBINE</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_blades</span> <span class="pre">(int)</span></code>: number of blades used to group readouts into
and partition the k-space. It should be lower than <code class="docutils literal notranslate"><span class="pre">Nc</span></code> and divide it.
See TURBINE</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_blade_revolutions</span> <span class="pre">(float)</span></code>: number of revolutions over
lines/spirals within a blade over the <span class="math notranslate nohighlight">\(k_z\)</span> axis. See TURBINE</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blade_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: angle between each consecutive blades
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis (in radians).
<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;uniform&quot;)</span></code>. See TURBINE</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_trains</span> <span class="pre">(int)</span></code>: number of resulting shots, or readout trains,
such that each of them will be composed of <span class="math notranslate nohighlight">\(n\)</span> readouts with
<code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">=</span> <span class="pre">n</span> <span class="pre">*</span> <span class="pre">nb_trains</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> then <code class="docutils literal notranslate"><span class="pre">nb_trains</span></code> is set
to <code class="docutils literal notranslate"><span class="pre">nb_blades</span></code>. See TURBINE</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_spiral_revolutions</span> <span class="pre">(float)</span></code>: number of revolutions performed
from the center. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">1)</span></code>. See 2D spiral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spiral</span> <span class="pre">(str,</span> <span class="pre">float)</span></code>: type of spiral defined through the general
archimedean equation. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;archimedes&quot;)</span></code>. See 2D spiral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: define whether the shots should travel toward the center
then outside (in-out) or not (center-out). <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">True)</span></code>. See 3D radial</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_repi</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span>
    <span class="n">nb_blade_revolutions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="p">,</span>
    <span class="n">nb_spiral_revolutions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_046.png" srcset="../../_images/sphx_glr_example_3D_trajectories_046.png" alt="example 3D trajectories" class = "sphx-glr-single-img"/><section id="nb-blade-revolutions-float">
<h4><code class="docutils literal notranslate"><span class="pre">nb_blade_revolutions</span> <span class="pre">(float)</span></code><a class="headerlink" href="#nb-blade-revolutions-float" title="Link to this heading">#</a></h4>
<p>Number of revolutions over lines/spirals within a blade
over the <span class="math notranslate nohighlight">\(k_z\)</span> axis.</p>
<p>Note that increasing it also tends to increase the distance
between consecutive lines/spirals, requiring higher gradients
and slew rates.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_repi</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span>
    <span class="n">nb_blade_revolutions</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">nb_spiral_revolutions</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_047.png" srcset="../../_images/sphx_glr_example_3D_trajectories_047.png" alt="0, 0.5, 1, 2" class = "sphx-glr-single-img"/><p>Same but with a spiral pattern instead of radial.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_repi</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">Ns_readouts</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_blades</span></a><span class="p">,</span>
    <span class="n">nb_blade_revolutions</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">nb_spiral_revolutions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_3D_trajectories_048.png" srcset="../../_images/sphx_glr_example_3D_trajectories_048.png" alt="0, 0.5, 1, 2" class = "sphx-glr-single-img"/></section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="wr94" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>WR94<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id5">2</a>)</span>
<p>Wong, Sam TS, and Mark S. Roos.
A strategy for sampling on a sphere applied
to 3D selective RF pulse design.
Magnetic Resonance in Medicine 32, no. 6 (1994): 778-784.</p>
</div>
<div class="citation" id="in95" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>IN95<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id14">1</a>,<a role="doc-backlink" href="#id18">2</a>)</span>
<p>Irarrazabal, Pablo, and Dwight G. Nishimura.
Fast three dimensional magnetic resonance imaging.
Magnetic Resonance in Medicine 33, no. 5 (1995): 656-662.</p>
</div>
<div class="citation" id="er00" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Er00<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id11">1</a>,<a role="doc-backlink" href="#id24">2</a>)</span>
<p>Erds, Paul.
Spiraling the earth with C. G. J. Jacobi.
American Journal of Physics 68, no. 10 (2000): 888-895.</p>
</div>
<div class="citation" id="yrb06" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>YRB06<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id17">1</a>,<a role="doc-backlink" href="#id19">2</a>,<a role="doc-backlink" href="#id20">3</a>,<a role="doc-backlink" href="#id22">4</a>)</span>
<p>Shu, Yunhong, Stephen J. Riederer, and Matt A. Bernstein.
Threedimensional MRI with an undersampled spherical shells trajectory.
Magnetic Resonance in Medicine 56, no. 3 (2006): 553-562.</p>
</div>
<div class="citation" id="br09" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Br09<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id12">1</a>,<a role="doc-backlink" href="#id25">2</a>)</span>
<p>Brizard, Alain J.
A primer on elliptic functions with applications in classical mechanics.
European journal of physics 30, no. 4 (2009): 729.</p>
</div>
<div class="citation" id="cha-09" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Cha+09</a><span class="fn-bracket">]</span></span>
<p>Chan, Rachel W., Elizabeth A. Ramsay,
Charles H. Cunningham, and Donald B. Plewes.
Temporal stability of adaptive 3D radial MRI
using multidimensional golden means.
Magnetic Resonance in Medicine 61, no. 2 (2009): 354-363.</p>
</div>
<div class="citation" id="mgm10" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>MGM10<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id26">1</a>,<a role="doc-backlink" href="#id30">2</a>)</span>
<p>McNab, Jennifer A., Daniel Gallichan, and Karla L. Miller.
3D steadystate diffusionweighted imaging with trajectory using
radially batched internal navigator echoes (TURBINE).
Magnetic Resonance in Medicine 63, no. 1 (2010): 235-242.</p>
</div>
<div class="citation" id="hm11" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id21">HM11</a><span class="fn-bracket">]</span></span>
<p>Gerlach, Henryk, and Heiko von der Mosel.
On sphere-filling ropes.
The American Mathematical Monthly 118, no. 10 (2011): 863-876</p>
</div>
<div class="citation" id="pic-11" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Pic+11</a><span class="fn-bracket">]</span></span>
<p>Piccini, Davide, Arne Littmann,
Sonia NiellesVallespin, and Michael O. Zenge.
Spiral phyllotaxis: the natural way to construct
a 3D radial trajectory in MRI.
Magnetic resonance in medicine 66, no. 4 (2011): 1049-1056.</p>
</div>
<div class="citation" id="pip-11" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Pip+11<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id6">1</a>,<a role="doc-backlink" href="#id7">2</a>)</span>
<p>Pipe, James G., Nicholas R. Zwart, Eric A. Aboussouan,
Ryan K. Robison, Ajit Devaraj, and Kenneth O. Johnson.
A new design and rationale for 3D orthogonally
oversampled kspace trajectories.
Magnetic resonance in medicine 66, no. 5 (2011): 1303-1311.</p>
</div>
<div class="citation" id="bil-15" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">Bil+15</a><span class="fn-bracket">]</span></span>
<p>Bilgic, Berkin, Borjan A. Gagoski, Stephen F. Cauley, Audrey P. Fan,
Jonathan R. Polimeni, P. Ellen Grant, Lawrence L. Wald, and Kawin Setsompop.
WaveCAIPI for highly accelerated 3D imaging.
Magnetic resonance in medicine 73, no. 6 (2015): 2152-2162.</p>
</div>
<div class="citation" id="par-16" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Par+16</a><span class="fn-bracket">]</span></span>
<p>Park, Jinil, Taehoon Shin, Soon Ho Yoon,
Jin Mo Goo, and JangYeon Park.
A radial sampling strategy for uniform kspace coverage
with retrospective respiratory gating
in 3D ultrashortechotime lung imaging.
NMR in Biomedicine 29, no. 5 (2016): 576-587.</p>
</div>
<div class="citation" id="smr18" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>SMR18<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id10">1</a>,<a role="doc-backlink" href="#id16">2</a>,<a role="doc-backlink" href="#id23">3</a>)</span>
<p>Speidel, Tobias, Patrick Metze, and Volker Rasche.
Efficient 3D Low-Discrepancy k-Space Sampling
Using Highly Adaptable Seiffert Spirals.
IEEE Transactions on Medical Imaging 38, no. 8 (2018): 1833-1840.</p>
</div>
<div class="citation" id="sb21" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">SB21</a><span class="fn-bracket">]</span></span>
<p>Stobbe, Robert W., and Christian Beaulieu.
Threedimensional Yarnball kspace acquisition for accelerated MRI.
Magnetic Resonance in Medicine 85, no. 4 (2021): 1840-1854.</p>
</div>
<div class="citation" id="gmc22" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>GMC22<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id27">1</a>,<a role="doc-backlink" href="#id28">2</a>)</span>
<p>Graedel, Nadine N., Karla L. Miller, and Mark Chiew.
Ultrahigh resolution fMRI at 7T using radialcartesian TURBINE sampling.
Magnetic Resonance in Medicine 88, no. 5 (2022): 2058-2073.</p>
</div>
<div class="citation" id="rms22" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id29">RMS22</a><span class="fn-bracket">]</span></span>
<p>Rettenmeier, Christoph A., Danilo Maziero, and V. Andrew Stenger.
Three dimensional radial echo planar imaging for functional MRI.
Magnetic Resonance in Medicine 87, no. 1 (2022): 193-206.</p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (1 minutes 1.686 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-autoexamples-example-3d-trajectories-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/mind-inria/mri-nufft/gh-pages?urlpath=lab/tree/examples/generated/autoexamples/example_3D_trajectories.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo1.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e21c725109b539d73664946e3d8ccf28/example_3D_trajectories.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_3D_trajectories.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e740f3fb12e197b564d5a694d170a8cd/example_3D_trajectories.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_3D_trajectories.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ecff5db0d530c01f65853d24ac7d55b5/example_3D_trajectories.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">example_3D_trajectories.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="example_2D_trajectories.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2D Trajectories</p>
      </div>
    </a>
    <a class="right-next"
       href="example_gif_2D.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Animated 2D trajectories</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#script-options">Script options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#radial-trajectories">Radial trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyllotaxis-radial">Phyllotaxis radial</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nc-int"><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ns-int"><code class="docutils literal notranslate"><span class="pre">Ns</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#in-out-bool"><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#golden-means-radial">Golden means radial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wong-radial">Wong radial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#park-radial">Park radial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#freeform-trajectories">Freeform trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-cones">3D Cones</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tilt-str-float"><code class="docutils literal notranslate"><span class="pre">tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-zigzags-float"><code class="docutils literal notranslate"><span class="pre">nb_zigzags</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiral-str-float"><code class="docutils literal notranslate"><span class="pre">spiral</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#width-float"><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#floret">FLORET</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-tuple"><code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">(tuple)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wave-caipi">Wave-CAIPI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-revolutions-float"><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#packing-str"><code class="docutils literal notranslate"><span class="pre">packing</span> <span class="pre">(str)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shape-str-float"><code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spacing-tuple-int-int"><code class="docutils literal notranslate"><span class="pre">spacing</span> <span class="pre">(tuple(int,</span> <span class="pre">int))</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seiffert-spirals-yarnball">Seiffert spirals / Yarnball</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-index-float"><code class="docutils literal notranslate"><span class="pre">curve_index</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><code class="docutils literal notranslate"><span class="pre">nb_revolutions</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axis-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">axis_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiral-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">spiral_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shell-trajectories">Shell trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helical-shells">Helical shells</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-shells-int"><code class="docutils literal notranslate"><span class="pre">nb_shells</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiral-reduction-float"><code class="docutils literal notranslate"><span class="pre">spiral_reduction</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shell-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">shell_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shot-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">shot_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annular-shells">Annular shells</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ring-tilt-float"><code class="docutils literal notranslate"><span class="pre">ring_tilt</span> <span class="pre">(float)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seiffert-shells">Seiffert shells</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fmri-trajectories">fMRI trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#turbine">TURBINE</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ns-transitions-int"><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-blades-int"><code class="docutils literal notranslate"><span class="pre">nb_blades</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#blade-tilt-str-float"><code class="docutils literal notranslate"><span class="pre">blade_tilt</span> <span class="pre">(str,</span> <span class="pre">float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-trains-int"><code class="docutils literal notranslate"><span class="pre">nb_trains</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#skip-factor-int"><code class="docutils literal notranslate"><span class="pre">skip_factor</span> <span class="pre">(int)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#repi">REPI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nb-blade-revolutions-float"><code class="docutils literal notranslate"><span class="pre">nb_blade_revolutions</span> <span class="pre">(float)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By MRI-NUFFT Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2022, MRI-NUFFT Contributors.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>