
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Trajectory tools &#8212; MRI-nufft Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/autoexamples/example_trajectory_tools';</script>
    <link rel="icon" href="../../_static/mri-nufft-icon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="GPU Examples" href="GPU/index.html" />
    <link rel="prev" title="3D Trajectories" href="example_3D_trajectories.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/mri-nufft.png" class="logo__image only-light" alt="MRI-nufft Documentation - Home"/>
    <script>document.write(`<img src="../../_static/mri-nufft.png" class="logo__image only-dark" alt="MRI-nufft Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    MRI-NUFFT
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>

<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="example_stacked.html">Stacked NUFFT Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_readme.html">Minimal Example script</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_display_config.html">Trajectory display configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_gif_3D.html">3D Trajectories display</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_2D_trajectories.html">2D Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_gif_2D.html">2D Trajectories display</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_learn_samples_multires.html">Learn Sampling pattern with multi-resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_3D_trajectories.html">3D Trajectories</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Trajectory tools</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="GPU/index.html">GPU Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_density.html">Density Compensation Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_learn_samples.html">Learn Sampling pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_learn_samples_multicoil.html">Learn Sampling pattern for multi-coil MRI</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPU/example_learn_straight_line_readouts.html">Learn Straight line readout pattern</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explanations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../nufft.html">The NUFFT Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory_gradspec.html">The trajectory binary file specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mrinufft_convention.html">MRI-NUFFT Interfaces Convention</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.operators</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.autodiff.html"><code class="docutils literal notranslate"><span class="pre">operators.autodiff</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.autodiff.MRINufftAutoGrad.html">MRINufftAutoGrad</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.html"><code class="docutils literal notranslate"><span class="pre">operators.base</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.check_backend.html">check_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.get_operator.html">get_operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.list_backends.html">list_backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.with_numpy.html">with_numpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.with_numpy_cupy.html">with_numpy_cupy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.with_tensorflow.html">with_tensorflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.with_torch.html">with_torch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.FourierOperatorBase.html">FourierOperatorBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.base.FourierOperatorCPU.html">FourierOperatorCPU</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.html"><code class="docutils literal notranslate"><span class="pre">operators.interfaces</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.bart.html"><code class="docutils literal notranslate"><span class="pre">interfaces.bart</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.bart.MRIBartNUFFT.html">MRIBartNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.bart.RawBartNUFFT.html">RawBartNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.cufinufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.cufinufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.cufinufft.MRICufiNUFFT.html">MRICufiNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.cufinufft.RawCufinufftPlan.html">RawCufinufftPlan</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.finufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.finufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.finufft.MRIfinufft.html">MRIfinufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.finufft.RawFinufftPlan.html">RawFinufftPlan</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.gpunufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.make_pinned_smaps.html">make_pinned_smaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.MRIGpuNUFFT.html">MRIGpuNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.gpunufft.RawGpuNUFFT.html">RawGpuNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.nfft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.get_fourier_matrix.html">get_fourier_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.MRInfft.html">MRInfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nfft.RawPyNFFT.html">RawPyNFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.html"><code class="docutils literal notranslate"><span class="pre">interfaces.nudft_numpy</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.get_fourier_matrix.html">get_fourier_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.get_implicit_matrix.html">get_implicit_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.implicit_type1_ndft.html">implicit_type1_ndft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.implicit_type2_ndft.html">implicit_type2_ndft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.MRInumpy.html">MRInumpy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.nudft_numpy.RawNDFT.html">RawNDFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.html"><code class="docutils literal notranslate"><span class="pre">interfaces.pynufft_cpu</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.MRIPynufft.html">MRIPynufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.RawPyNUFFT.html">RawPyNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.sigpy.html"><code class="docutils literal notranslate"><span class="pre">interfaces.sigpy</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.sigpy.MRISigpyNUFFT.html">MRISigpyNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.sigpy.RawSigpyNUFFT.html">RawSigpyNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.tfnufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.tfnufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.tfnufft.MRITensorflowNUFFT.html">MRITensorflowNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.torchkbnufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.MRITorchKbNufft.html">MRITorchKbNufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.TorchKbNUFFTcpu.html">TorchKbNUFFTcpu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.torchkbnufft.TorchKbNUFFTgpu.html">TorchKbNUFFTgpu</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.utils.html"><code class="docutils literal notranslate"><span class="pre">interfaces.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.utils.gpu_utils.html"><code class="docutils literal notranslate"><span class="pre">utils.gpu_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../_autosummary/mrinufft.operators.interfaces.utils.utils.html"><code class="docutils literal notranslate"><span class="pre">utils.utils</span></code></a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.off_resonnance.html"><code class="docutils literal notranslate"><span class="pre">operators.off_resonnance</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.off_resonnance.MRIFourierCorrected.html">MRIFourierCorrected</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.html"><code class="docutils literal notranslate"><span class="pre">operators.stacked</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.stacked2traj3d.html">stacked2traj3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.traj3d2stacked.html">traj3d2stacked</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.MRIStackedNUFFT.html">MRIStackedNUFFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.operators.stacked.MRIStackedNUFFTGPU.html">MRIStackedNUFFTGPU</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.trajectories</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.html"><code class="docutils literal notranslate"><span class="pre">trajectories.display</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_2D_trajectory.html">display_2D_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_3D_trajectory.html">display_3D_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_gradients.html">display_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.display_gradients_simply.html">display_gradients_simply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.display.displayConfig.html">displayConfig</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.gradients.html"><code class="docutils literal notranslate"><span class="pre">trajectories.gradients</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.gradients.patch_center_anomaly.html">patch_center_anomaly</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.html"><code class="docutils literal notranslate"><span class="pre">trajectories.maths</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.R2D.html">R2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Ra.html">Ra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Rv.html">Rv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Rx.html">Rx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Ry.html">Ry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.Rz.html">Rz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.compute_coprime_factors.html">compute_coprime_factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.generate_fibonacci_circle.html">generate_fibonacci_circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.generate_fibonacci_lattice.html">generate_fibonacci_lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.generate_fibonacci_sphere.html">generate_fibonacci_sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.get_closest_fibonacci_number.html">get_closest_fibonacci_number</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.maths.is_from_fibonacci_sequence.html">is_from_fibonacci_sequence</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.html"><code class="docutils literal notranslate"><span class="pre">trajectories.tools</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.conify.html">conify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.duplicate_along_axes.html">duplicate_along_axes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.epify.html">epify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.precess.html">precess</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.prewind.html">prewind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.radialize_center.html">radialize_center</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.rewind.html">rewind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.rotate.html">rotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.shellify.html">shellify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.stack.html">stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.stack_spherically.html">stack_spherically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.tools.unepify.html">unepify</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.html"><code class="docutils literal notranslate"><span class="pre">trajectories.trajectory2D</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_cones.html">initialize_2D_cones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_fibonacci_spiral.html">initialize_2D_fibonacci_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_lissajous.html">initialize_2D_lissajous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_polar_lissajous.html">initialize_2D_polar_lissajous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_propeller.html">initialize_2D_propeller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_radial.html">initialize_2D_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_rings.html">initialize_2D_rings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_rosette.html">initialize_2D_rosette</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_sinusoide.html">initialize_2D_sinusoide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_spiral.html">initialize_2D_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_waves.html">initialize_2D_waves</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.html"><code class="docutils literal notranslate"><span class="pre">trajectories.trajectory3D</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_REPI.html">initialize_3D_REPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_TURBINE.html">initialize_3D_TURBINE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_annular_shells.html">initialize_3D_annular_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_cones.html">initialize_3D_cones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_floret.html">initialize_3D_floret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_golden_means_radial.html">initialize_3D_golden_means_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_helical_shells.html">initialize_3D_helical_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_park_radial.html">initialize_3D_park_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_phyllotaxis_radial.html">initialize_3D_phyllotaxis_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_seiffert_shells.html">initialize_3D_seiffert_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_seiffert_spiral.html">initialize_3D_seiffert_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_wave_caipi.html">initialize_3D_wave_caipi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_wong_radial.html">initialize_3D_wong_radial</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.html"><code class="docutils literal notranslate"><span class="pre">trajectories.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.check_hardware_constraints.html">check_hardware_constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.compute_gradients_and_slew_rates.html">compute_gradients_and_slew_rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_gradients_to_slew_rates.html">convert_gradients_to_slew_rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_gradients_to_trajectory.html">convert_gradients_to_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_slew_rates_to_gradients.html">convert_slew_rates_to_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.convert_trajectory_to_gradients.html">convert_trajectory_to_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.initialize_algebraic_spiral.html">initialize_algebraic_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.initialize_shape_norm.html">initialize_shape_norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.initialize_tilt.html">initialize_tilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.normalize_trajectory.html">normalize_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.unnormalize_trajectory.html">unnormalize_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.CaseInsensitiveEnumMeta.html">CaseInsensitiveEnumMeta</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.FloatEnum.html">FloatEnum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Gammas.html">Gammas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.NormShapes.html">NormShapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Packings.html">Packings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Spirals.html">Spirals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.trajectories.utils.Tilts.html">Tilts</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.density</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.html"><code class="docutils literal notranslate"><span class="pre">density.geometry_based</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.cell_count.html">cell_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.voronoi.html">voronoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.geometry_based.voronoi_unique.html">voronoi_unique</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.nufft_based.html"><code class="docutils literal notranslate"><span class="pre">density.nufft_based</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.nufft_based.pipe.html">pipe</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.html"><code class="docutils literal notranslate"><span class="pre">density.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.flat_traj.html">flat_traj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.get_density.html">get_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.density.utils.normalize_weights.html">normalize_weights</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.io</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.cfl.html"><code class="docutils literal notranslate"><span class="pre">io.cfl</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.cfl.cfl2traj.html">cfl2traj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.cfl.traj2cfl.html">traj2cfl</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.html"><code class="docutils literal notranslate"><span class="pre">io.nsp</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.read_arbgrad_rawdat.html">read_arbgrad_rawdat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.read_trajectory.html">read_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.write_gradients.html">write_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.nsp.write_trajectory.html">write_trajectory</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.siemens.html"><code class="docutils literal notranslate"><span class="pre">io.siemens</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.siemens.read_siemens_rawdat.html">read_siemens_rawdat</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.io.utils.html"><code class="docutils literal notranslate"><span class="pre">io.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.io.utils.add_phase_to_kspace_with_shifts.html">add_phase_to_kspace_with_shifts</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.extras</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.smaps.html"><code class="docutils literal notranslate"><span class="pre">extras.smaps</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.smaps.low_frequency.html">low_frequency</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../_autosummary/mrinufft.extras.utils.html"><code class="docutils literal notranslate"><span class="pre">extras.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../_autosummary/mrinufft.extras.utils.get_smaps.html">get_smaps</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/mrinufft._utils.html"><code class="docutils literal notranslate"><span class="pre">mrinufft._utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.auto_cast.html">auto_cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.get_array_module.html">get_array_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.power_method.html">power_method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.proper_trajectory.html">proper_trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/mrinufft._utils.MethodRegister.html">MethodRegister</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellanneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../misc/contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/development.html">Developing MRI-nufft</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Related Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://cea-cosmic.github.io/pysap">PySAP</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cea-cosmic.github.io/ModOpt/">ModOpt</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/paquiteau/brainweb-dl">Brainweb-dl</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft/edit/main/generated/autoexamples/example_trajectory_tools.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft/issues/new?title=Issue%20on%20page%20%2Fgenerated/autoexamples/example_trajectory_tools.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/generated/autoexamples/example_trajectory_tools.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Trajectory tools</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#script-options">Script options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-tools">Direct tools</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#single-shots">Single shots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#planes">Planes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stack">Stack</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-array"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hard-bounded-bool"><code class="docutils literal notranslate"><span class="pre">hard_bounded</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotate">Rotate</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precess">Precess</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#half-sphere-bool"><code class="docutils literal notranslate"><span class="pre">half_sphere</span> <span class="pre">(bool)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-str"><code class="docutils literal notranslate"><span class="pre">partition</span> <span class="pre">(str)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axis-int-array"><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">(int,</span> <span class="pre">array)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conify">Conify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#max-angle-float"><code class="docutils literal notranslate"><span class="pre">max_angle</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#borderless-bool"><code class="docutils literal notranslate"><span class="pre">borderless</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#epify">Epify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nc-trains-int"><code class="docutils literal notranslate"><span class="pre">Nc_trains</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ns-transitions-int"><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-odd-shots-bool"><code class="docutils literal notranslate"><span class="pre">reverse_odd_shots</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prewind-rewind">Prewind/rewind</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-tools">Functional tools</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-spherically">Stack spherically</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-func-function"><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shellify">Shellify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hemisphere-mode-str"><code class="docutils literal notranslate"><span class="pre">hemisphere_mode</span> <span class="pre">(str)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-generated-autoexamples-example-trajectory-tools-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="trajectory-tools">
<span id="sphx-glr-generated-autoexamples-example-trajectory-tools-py"></span><h1>Trajectory tools<a class="headerlink" href="#trajectory-tools" title="Link to this heading">#</a></h1>
<p>A collection of tools to manipulate and develop non-Cartesian trajectories.</p>
<p>Hereafter we detail and illustrate different generic tools that can
be used and combined to create custom trajectories. Most of them are
already present in the proposed trajectories from the literature.
Since most arguments are redundant across the different patterns,
some of the documentation will refer to previous patterns for explanation.
Also note that not all possibilities are relevant for MR applications
since these functions are only tools to simplify trajectory design.</p>
<p>In this page, we invite the user to manually run the script to be able
to manipulate the plot orientations with the matplotlib interface to better
visualize the 3D volumes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># External</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Internal</span>
<span class="kn">import</span> <span class="nn">mrinufft</span> <span class="k">as</span> <span class="nn">mn</span>
<span class="kn">import</span> <span class="nn">mrinufft.trajectories.tools</span> <span class="k">as</span> <span class="nn">tools</span>

<span class="kn">from</span> <span class="nn">mrinufft.trajectories.utils</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">KMAX</span></a>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">show_argument</span><span class="p">,</span> <span class="n">show_trajectory</span>
</pre></div>
</div>
<section id="script-options">
<h2>Script options<a class="headerlink" href="#script-options" title="Link to this heading">#</a></h2>
<p>These options are used in the examples below as default values for all trajectories.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Trajectory parameters</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># Number of shots</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># Number of samples per shot</span>
<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Choose between in-out or center-out trajectories</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Number of stacks, rotations, cones, shells etc.</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Number of revolutions for base trajectories</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_zigzags</span></a> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Number of zigzags for base trajectories</span>

<span class="c1"># Display parameters</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Figure size for trajectory plots</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Figure size for subplots</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <span class="mi">3</span>  <span class="c1"># Highlight one shot in particular</span>
</pre></div>
</div>
</section>
<section id="direct-tools">
<h2>Direct tools<a class="headerlink" href="#direct-tools" title="Link to this heading">#</a></h2>
<p>In this section are presented the tools to apply over already
instanciated trajectories, i.e. arrays of size <span class="math notranslate nohighlight">\((N_c, N_s, N_d)\)</span>
with <span class="math notranslate nohighlight">\(N_c\)</span> the number of shots, <span class="math notranslate nohighlight">\(N_s\)</span> the number of samples
per shot and <span class="math notranslate nohighlight">\(N_d\)</span> the number of dimensions (2 or 3).</p>
<section id="preparation">
<h3>Preparation<a class="headerlink" href="#preparation" title="Link to this heading">#</a></h3>
<section id="single-shots">
<h4>Single shots<a class="headerlink" href="#single-shots" title="Link to this heading">#</a></h4>
<p>We can define a few simple trajectories to use in later examples:
Single shots from 2D radial, Fermats spiral, and 2D/3D cones.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Radial&quot;</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_2D_radial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">),</span>
    <span class="s2">&quot;Spiral&quot;</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_2D_spiral</span><span class="p">(</span>
        <span class="mi">1</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <span class="n">spiral</span><span class="o">=</span><span class="s2">&quot;fermat&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a>
    <span class="p">),</span>
    <span class="s2">&quot;2D Cones&quot;</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_2D_cones</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_zigzags</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_zigzags</span></a>
    <span class="p">)[:</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;3D Cones&quot;</span><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_3D_cones</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_zigzags</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_zigzags</span></a><span class="p">)[</span>
        <span class="p">:</span><span class="mi">1</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">),</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_001.png" srcset="../../_images/sphx_glr_example_trajectory_tools_001.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
<section id="planes">
<h4>Planes<a class="headerlink" href="#planes" title="Link to this heading">#</a></h4>
<p>We will also be using them as planes, or thick planes for 3D shots.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">//</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Radial&quot;</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span> <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a>
    <span class="p">),</span>
    <span class="s2">&quot;Spiral&quot;</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Spiral&quot;</span><span class="p">],</span> <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a>
    <span class="p">),</span>
    <span class="s2">&quot;2D Cones&quot;</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;2D Cones&quot;</span><span class="p">],</span> <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a>
    <span class="p">),</span>
    <span class="s2">&quot;3D Cones&quot;</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;3D Cones&quot;</span><span class="p">],</span> <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">),</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_002.png" srcset="../../_images/sphx_glr_example_trajectory_tools_002.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
</section>
<section id="stack">
<h3>Stack<a class="headerlink" href="#stack" title="Link to this heading">#</a></h3>
<p>The oldest and most widely used method is to simply stack any plane
on top of itself, until it reaches the desired number of slices.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code>: array of k-space coordinates of
size <span class="math notranslate nohighlight">\((N_c, N_s, N_d)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_stacks</span> <span class="pre">(int)</span></code>: number of stacks repeating <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">z_tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive stacks
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">None)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hard_bounded</span> <span class="pre">(bool)</span></code>: whether the stacks should be
strictly bounded to k-space. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">True)</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span> <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_003.png" srcset="../../_images/sphx_glr_example_trajectory_tools_003.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="trajectory-array">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code><a class="headerlink" href="#trajectory-array" title="Link to this heading">#</a></h4>
<p>The main use case is to stack trajectories consisting of
flat or thick planes that will match the image slices.
Some stacks can also be removed afterward to create GRAPPA-like
patterns that will rely on parallel imaging and sensitivity maps
to recover the missing information.
Stacking planes without tilting them is notably compatible
with stacked-NUFFT operators, reducing time and memory
consumption during reconstruction.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_004.png" srcset="../../_images/sphx_glr_example_trajectory_tools_004.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_005.png" srcset="../../_images/sphx_glr_example_trajectory_tools_005.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><p>It can also be applied twice to single shots to create
a plane before stacking it over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis.
Note here that is does not make a lot of sense for
non-radial trajectories such as spirals.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.roll.html#numpy.roll" title="numpy.roll" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">roll</span></a><span class="p">(</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a><span class="p">),</span>
        <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">shift</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_006.png" srcset="../../_images/sphx_glr_example_trajectory_tools_006.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
<section id="hard-bounded-bool">
<h4><code class="docutils literal notranslate"><span class="pre">hard_bounded</span> <span class="pre">(bool)</span></code><a class="headerlink" href="#hard-bounded-bool" title="Link to this heading">#</a></h4>
<p>The stack is <code class="docutils literal notranslate"><span class="pre">hard_bounded</span></code> when the positions of the stacks
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis are squeezed such that the lower and upper
stacks dont exceed the k-space boundaries when the plane is thick.
In the example below, the thickness is deliberately increased to
emphasize this point.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.copy.html#numpy.copy" title="numpy.copy" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">copy</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;3D Cones&quot;</span><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <span class="n">hard_bounded</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_007.png" srcset="../../_images/sphx_glr_example_trajectory_tools_007.png" alt="True, False" class = "sphx-glr-single-img"/></section>
</section>
<section id="rotate">
<h3>Rotate<a class="headerlink" href="#rotate" title="Link to this heading">#</a></h3>
<p>A simple method to duplicate any trajectory with a rotation over
one or multiple axes at the same time.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code>: array of k-space coordinates of
size <span class="math notranslate nohighlight">\((N_c, N_s, N_d)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_rotations</span> <span class="pre">(int)</span></code>: number of rotations repeating <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive stacks
over the <span class="math notranslate nohighlight">\(k_x\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">None)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y_tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive stacks
over the <span class="math notranslate nohighlight">\(k_y\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">None)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">z_tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive stacks
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">None)</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span> <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <span class="n">x_tilt</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_008.png" srcset="../../_images/sphx_glr_example_trajectory_tools_008.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="id1">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code><a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>A common application is to rotate a single shot to create a plane
as used earlier to initialize the planar trajectories. It has also
been used in the literature to rotate planes around one axis to
create 3D trajectories, but the density (and redundancy) along that
axis is then much greater than anywhere else.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <span class="n">x_tilt</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_009.png" srcset="../../_images/sphx_glr_example_trajectory_tools_009.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_010.png" srcset="../../_images/sphx_glr_example_trajectory_tools_010.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
</section>
<section id="precess">
<h3>Precess<a class="headerlink" href="#precess" title="Link to this heading">#</a></h3>
<p>A method to duplicate a trajectory while applying a
precession-like rotation around a provided axis.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code>: array of k-space coordinates of
size <span class="math notranslate nohighlight">\((N_c, N_s, N_d)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_rotations</span> <span class="pre">(int)</span></code>: number of rotations repeating <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive rotations
around the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;golden&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">half_sphere</span> <span class="pre">(bool)</span></code>: whether the precession should be limited
to the upper half of the k-space sphere, typically for in-out
trajectories or planes. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">partition</span> <span class="pre">(str)</span></code>: partition type between an axial or polar
split of the <span class="math notranslate nohighlight">\(k_z\)</span>-axis, designating whether the axis should
be fragmented by radius or angle respectively. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;axial&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">(int,</span> <span class="pre">array)</span></code>: axis selected for alignment reference
when rotating the trajectory around the <span class="math notranslate nohighlight">\(k_z\)</span>-axis,
generally corresponding to the shot direction for
single shot <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> inputs. It can either be an integer for
one of the three k-space axes, or directly a 3D array.
The default behavior when <code class="docutils literal notranslate"><span class="pre">None</span></code> is to select the last coordinate
of the first shot as the axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">None)</span></code></p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">half_sphere</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_011.png" srcset="../../_images/sphx_glr_example_trajectory_tools_011.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="id2">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code><a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>This method provides a way to distribute duplicated trajectories
(single shots, planes or anything else) to cover evenly a provided
axis tilting the azimuthal orientation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">half_sphere</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_012.png" srcset="../../_images/sphx_glr_example_trajectory_tools_012.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><p>It is however most often used with single shots to
cover more evenly the k-space sphere, such as with 3D cones
or Seiffert spirals. Indeed, applying a precession with
the golden angle is known to approximate an even distribution
of points over a sphere surface.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">half_sphere</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_013.png" srcset="../../_images/sphx_glr_example_trajectory_tools_013.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
<section id="half-sphere-bool">
<h4><code class="docutils literal notranslate"><span class="pre">half_sphere</span> <span class="pre">(bool)</span></code><a class="headerlink" href="#half-sphere-bool" title="Link to this heading">#</a></h4>
<p>Whether the precession should be limited to the upper half
of the k-space sphere (with respect to the provided axis).
It is typically used for in-out trajectories or planes, as
otherwise shots would likely be stacked in a redundant way.</p>
<p>In the example hereafter, center-out shots are shown for clarity.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">][:,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">)</span> <span class="p">:],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">half_sphere</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_014.png" srcset="../../_images/sphx_glr_example_trajectory_tools_014.png" alt="True, False" class = "sphx-glr-single-img"/></section>
<section id="partition-str">
<h4><code class="docutils literal notranslate"><span class="pre">partition</span> <span class="pre">(str)</span></code><a class="headerlink" href="#partition-str" title="Link to this heading">#</a></h4>
<p>Partition type between an axial or polar
split of the <span class="math notranslate nohighlight">\(k_z\)</span>-axis, designating whether the axis should
be fragmented by radius or angle respectively.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;axial&quot;</span><span class="p">,</span> <span class="s2">&quot;polar&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_015.png" srcset="../../_images/sphx_glr_example_trajectory_tools_015.png" alt="axial, polar" class = "sphx-glr-single-img"/><p>While polar looks more natural in the absence of rotation (<code class="docutils literal notranslate"><span class="pre">tilt=None</span></code>),
it results in too many shots close to the rotation axis, and therefore
a non-uniform density. The best approximation of a uniform distribution
is obtained with an axial partition and golden tilt along
the provided axis.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;axial&quot;</span><span class="p">,</span> <span class="s2">&quot;polar&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_016.png" srcset="../../_images/sphx_glr_example_trajectory_tools_016.png" alt="axial, polar" class = "sphx-glr-single-img"/><p>The distribution over the k-space sphere surface can be shown by
displaying only the tip of the shots.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;axial&quot;</span><span class="p">,</span> <span class="s2">&quot;polar&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">][:,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">partition</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_017.png" srcset="../../_images/sphx_glr_example_trajectory_tools_017.png" alt="axial, polar" class = "sphx-glr-single-img"/></section>
<section id="axis-int-array">
<h4><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">(int,</span> <span class="pre">array)</span></code><a class="headerlink" href="#axis-int-array" title="Link to this heading">#</a></h4>
<p>Axis selected for alignment reference when rotating the trajectory
around the <span class="math notranslate nohighlight">\(k_z\)</span>-axis, generally corresponding to the
shot direction for single shot <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> inputs.
It can either be an integer for one of the three k-space axes,
or directly a 3D array. The default behavior when <cite>None</cite>
is to select the last coordinate of the first shot as the axis.</p>
<p>This argument is simple to select but still important, as the
precession relies on Rodrigues rotation coefficients that enable
a rotation from one vector to another to align the trajectory
through the provided axis with the precession vectors all over
the k-space sphere. However, misalignement between shots and the
provided axis will result in a non-uniform distribution, as the
rotation around the axis is unfavorably deterministic.</p>
<p>The first case is single shots, where the provided axis should
simply correspond to the shot axis.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">half_sphere</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_018.png" srcset="../../_images/sphx_glr_example_trajectory_tools_018.png" alt="None, 0, 1, 2" class = "sphx-glr-single-img"/><p>The second case is planar trajectories, where the axis orthogonal
to the shots plane is preferred.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">precess</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <span class="n">tilt</span><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span>
    <span class="n">half_sphere</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_019.png" srcset="../../_images/sphx_glr_example_trajectory_tools_019.png" alt="None, 0, 1, 2" class = "sphx-glr-single-img"/><p>Some trickier cases exist in the literature, with the example of Seiffert spirals.
Those 3D spirals neither correspond to a single-axis shot or a plane, so the authors
chose to use the center-out axis of each shot as a reference axis for the rotation.
In order to handle the redundant distribution, they added a pseudo-random rotation
within the shot axes.</p>
</section>
</section>
<section id="conify">
<h3>Conify<a class="headerlink" href="#conify" title="Link to this heading">#</a></h3>
<p>A tool to distort trajectories into multiple cones
positioned to cover the k-space sphere.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code>: array of k-space coordinates of
size <span class="math notranslate nohighlight">\((N_c, N_s, N_d)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_cones</span> <span class="pre">(int)</span></code>: number of cones repeating <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>
with conical distortion over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">z_tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive cones
around the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;golden&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_out</span> <span class="pre">(bool)</span></code>: whether to account for the in-out
nature of some trajectories to avoid hard angles
around the center, <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">False)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_angle</span> <span class="pre">(float)</span></code>: maximum angle of the cones. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">borderless</span> <span class="pre">(bool)</span></code>: Whether the cones should reach <cite>max_angle</cite> or not,
mostly to avoid 1D cones if <code class="docutils literal notranslate"><span class="pre">max_angle</span></code> is equal to pi / 2, by default True.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">conify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span> <span class="n">nb_cones</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_020.png" srcset="../../_images/sphx_glr_example_trajectory_tools_020.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="id3">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>The trajectory is folded toward the <span class="math notranslate nohighlight">\(k_z\)</span>-axis to shape cones,
and is therefore expected to be planar over the <span class="math notranslate nohighlight">\(k_x-k_y\)</span> axes.
Other configuration might result in irrelevant trajectories.
Also, the distortion is likely to increase the required gradient amplitudes
and slew rates.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">conify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">nb_cones</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_021.png" srcset="../../_images/sphx_glr_example_trajectory_tools_021.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_022.png" srcset="../../_images/sphx_glr_example_trajectory_tools_022.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><p>Similarly to other tools, it can be used with single shots.
In that case, <code class="docutils literal notranslate"><span class="pre">nb_cones</span></code> is set to <code class="docutils literal notranslate"><span class="pre">Nc</span></code> to create as many
individual cones.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">conify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">nb_cones</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a><span class="o">=</span><span class="s2">&quot;golden&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_023.png" srcset="../../_images/sphx_glr_example_trajectory_tools_023.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_024.png" srcset="../../_images/sphx_glr_example_trajectory_tools_024.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
<section id="max-angle-float">
<h4><code class="docutils literal notranslate"><span class="pre">max_angle</span> <span class="pre">(float)</span></code><a class="headerlink" href="#max-angle-float" title="Link to this heading">#</a></h4>
<p>Polar angle of the most folded cone. As pointed out in <a class="reference internal" href="#pip-11" id="id4"><span>[Pip+11]</span></a>,
folding planes over the whole sphere would result in inefficient
distributions near the <span class="math notranslate nohighlight">\(k_z\)</span>-axis, and it may be more relevant
to reduce the maximum angle but duplicate all of the cones along
another axis to still cover the whole k-space.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">conify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">nb_cones</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">max_angle</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_025.png" srcset="../../_images/sphx_glr_example_trajectory_tools_025.png" alt="1.5707963267948966, 1.0471975511965976, 0.7853981633974483, 0.6283185307179586" class = "sphx-glr-single-img"/></section>
<section id="borderless-bool">
<h4><code class="docutils literal notranslate"><span class="pre">borderless</span> <span class="pre">(bool)</span></code><a class="headerlink" href="#borderless-bool" title="Link to this heading">#</a></h4>
<p>Define whether or not the edge cones should reach <code class="docutils literal notranslate"><span class="pre">max_angle</span></code>
when equal to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or instead simply partition the
sphere over a polar split.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">conify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">nb_cones</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span>
    <span class="n">max_angle</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">borderless</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_026.png" srcset="../../_images/sphx_glr_example_trajectory_tools_026.png" alt="True, False" class = "sphx-glr-single-img"/></section>
</section>
<section id="epify">
<h3>Epify<a class="headerlink" href="#epify" title="Link to this heading">#</a></h3>
<p>A tool to assemble multiple single-readout shots together by
adding transition steps in the trajectory to create EPI-like
multi-readout shots.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">epify</span></code> tool is associated with an <code class="docutils literal notranslate"><span class="pre">unepify</span></code>
tool to revert the operation on trajectory or acquired data.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array_like)</span></code>: trajectory to change by prolonging
and merging the shots together.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nc_trains</span> <span class="pre">(int)</span></code>: number of resulting multi-readout shots,
or trains.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code>: number of samples/steps between the
merged readouts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reverse_odd_shots</span> <span class="pre">(bool)</span></code>: Whether to reverse every odd shots
such that, as in most trajectories, even shots end up closer to
the start of odd shots.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <a href="../_autosummary/mrinufft.trajectories.tools.epify.html#mrinufft.trajectories.tools.epify" title="mrinufft.trajectories.tools.epify" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">epify</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">Nc_trains</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">reverse_odd_shots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_027.png" srcset="../../_images/sphx_glr_example_trajectory_tools_027.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="id5">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code><a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<p>The trajectory to change by prolonging and merging the shots together.
Hereafter the shots are merged by pairs with short transitions.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="../_autosummary/mrinufft.trajectories.tools.epify.html#mrinufft.trajectories.tools.epify" title="mrinufft.trajectories.tools.epify" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">epify</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span>
    <span class="n">Nc_trains</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">reverse_odd_shots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_028.png" srcset="../../_images/sphx_glr_example_trajectory_tools_028.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_029.png" srcset="../../_images/sphx_glr_example_trajectory_tools_029.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
<section id="nc-trains-int">
<h4><code class="docutils literal notranslate"><span class="pre">Nc_trains</span> <span class="pre">(int)</span></code><a class="headerlink" href="#nc-trains-int" title="Link to this heading">#</a></h4>
<p>Number of resulting multi-readout shots, or trains.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="../_autosummary/mrinufft.trajectories.tools.epify.html#mrinufft.trajectories.tools.epify" title="mrinufft.trajectories.tools.epify" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">epify</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">Nc_trains</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">reverse_odd_shots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_030.png" srcset="../../_images/sphx_glr_example_trajectory_tools_030.png" alt="10, 5, 2, 1" class = "sphx-glr-single-img"/></section>
<section id="ns-transitions-int">
<h4><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code><a class="headerlink" href="#ns-transitions-int" title="Link to this heading">#</a></h4>
<p>Number of samples/steps between the merged readouts.
Smoother transitions are achieved with more points, but it means longer
waiting times between readouts if they are split during acquisition.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="../_autosummary/mrinufft.trajectories.tools.epify.html#mrinufft.trajectories.tools.epify" title="mrinufft.trajectories.tools.epify" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">epify</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;2D Cones&quot;</span><span class="p">],</span>
    <span class="n">Nc_trains</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">reverse_odd_shots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_031.png" srcset="../../_images/sphx_glr_example_trajectory_tools_031.png" alt="25, 50, 75, 100" class = "sphx-glr-single-img"/></section>
<section id="reverse-odd-shots-bool">
<h4><code class="docutils literal notranslate"><span class="pre">reverse_odd_shots</span> <span class="pre">(bool)</span></code><a class="headerlink" href="#reverse-odd-shots-bool" title="Link to this heading">#</a></h4>
<p>Whether to reverse every odd shots such that, as in most trajectories,
even shots end up closer to the start of odd shots.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="../_autosummary/mrinufft.trajectories.tools.epify.html#mrinufft.trajectories.tools.epify" title="mrinufft.trajectories.tools.epify" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">epify</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span>
    <span class="n">Nc_trains</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc_planes</span></a> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">reverse_odd_shots</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_032.png" srcset="../../_images/sphx_glr_example_trajectory_tools_032.png" alt="True, False" class = "sphx-glr-single-img"/></section>
</section>
<section id="prewind-rewind">
<h3>Prewind/rewind<a class="headerlink" href="#prewind-rewind" title="Link to this heading">#</a></h3>
<p>Two tools used to generate gradients before and after the trajectory.</p>
<p>The trajectory can be extended to start before the readout
from the k-space center with null gradients and reach
each shot position with the required gradient strength, and
then come back to the center.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array_like)</span></code>: trajectory to change by prolonging
and merging the shots together.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code>: number of pre-winding/rewinding steps.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <a href="../_autosummary/mrinufft.trajectories.tools.prewind.html#mrinufft.trajectories.tools.prewind" title="mrinufft.trajectories.tools.prewind" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">prewind</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Spiral&quot;</span><span class="p">],</span> <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <a href="../_autosummary/mrinufft.trajectories.tools.rewind.html#mrinufft.trajectories.tools.rewind" title="mrinufft.trajectories.tools.rewind" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">rewind</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_033.png" srcset="../../_images/sphx_glr_example_trajectory_tools_033.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="id6">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code><a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<p>The trajectory to change by extending them before and/or after
the readouts.</p>
<p>Note that the radial prewinding and rewinding parts are overlapping
with the actual trajectory.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="../_autosummary/mrinufft.trajectories.tools.prewind.html#mrinufft.trajectories.tools.prewind" title="mrinufft.trajectories.tools.prewind" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">prewind</span></a><span class="p">(</span>
    <a href="../_autosummary/mrinufft.trajectories.tools.rewind.html#mrinufft.trajectories.tools.rewind" title="mrinufft.trajectories.tools.rewind" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">rewind</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_034.png" srcset="../../_images/sphx_glr_example_trajectory_tools_034.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_035.png" srcset="../../_images/sphx_glr_example_trajectory_tools_035.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
<section id="id7">
<h4><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code><a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>Number of samples/steps before and/or after the readouts.
Smoother transitions are achieved with more points, but it may imply delayed
readout starts and longer TRs.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="../_autosummary/mrinufft.trajectories.tools.prewind.html#mrinufft.trajectories.tools.prewind" title="mrinufft.trajectories.tools.prewind" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">prewind</span></a><span class="p">(</span>
    <a href="../_autosummary/mrinufft.trajectories.tools.rewind.html#mrinufft.trajectories.tools.rewind" title="mrinufft.trajectories.tools.rewind" class="sphx-glr-backref-module-mrinufft-trajectories-tools sphx-glr-backref-type-py-function"><span class="n">tools</span><span class="o">.</span><span class="n">rewind</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planar_trajectories</span></a><span class="p">[</span><span class="s2">&quot;2D Cones&quot;</span><span class="p">],</span> <span class="n">Ns_transitions</span><span class="o">=</span><span class="n">x</span><span class="p">),</span>
    <span class="n">Ns_transitions</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_036.png" srcset="../../_images/sphx_glr_example_trajectory_tools_036.png" alt="25, 50, 75, 100" class = "sphx-glr-single-img"/></section>
</section>
</section>
<section id="functional-tools">
<h2>Functional tools<a class="headerlink" href="#functional-tools" title="Link to this heading">#</a></h2>
<section id="id8">
<h3>Preparation<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>We can define a few functions that will be used in the following
examples, using again 2D radial, Fermats spiral, and 2D/3D cones:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_trajectories</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Radial&quot;</span><span class="p">:</span> <span class="k">lambda</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_2D_radial</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">),</span>
    <span class="s2">&quot;Spiral&quot;</span><span class="p">:</span> <span class="k">lambda</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_2D_spiral</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <span class="n">spiral</span><span class="o">=</span><span class="s2">&quot;fermat&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_revolutions</span></a>
    <span class="p">),</span>
    <span class="s2">&quot;2D Cones&quot;</span><span class="p">:</span> <span class="k">lambda</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">:</span> <span class="n">mn</span><span class="o">.</span><span class="n">initialize_2D_cones</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Ns</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_zigzags</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_zigzags</span></a>
    <span class="p">),</span>
    <span class="s2">&quot;3D Cones&quot;</span><span class="p">:</span> <span class="k">lambda</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">single_trajectories</span></a><span class="p">[</span><span class="s2">&quot;3D Cones&quot;</span><span class="p">],</span>
        <span class="n">nb_rotations</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_tilt</span></a><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_out</span></a><span class="p">),</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="stack-spherically">
<h3>Stack spherically<a class="headerlink" href="#stack-spherically" title="Link to this heading">#</a></h3>
<p>A tool similar to <code class="docutils literal notranslate"><span class="pre">tools.stack</span></code> but with stacks shrinked
in order to cover the k-space sphere and a variable number
of shot per stack to improve the coverage over larger stacks.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code>: trajectory function that
should return an array-like with the usual <span class="math notranslate nohighlight">\((N_c, N_s, N_d)\)</span> size.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of shots to use for the whole spherically
stacked trajectory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_stacks</span> <span class="pre">(int)</span></code>: number of stacks repeating <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>
over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">z_tilt</span> <span class="pre">(float)</span></code>: angle tilt between consecutive stacks
around the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">None)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hard_bounded</span> <span class="pre">(bool)</span></code>: whether the stacks should be
strictly bounded to k-space. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">True)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>: trajectory initialization parameters for the
function provided with <code class="docutils literal notranslate"><span class="pre">trajectory_func</span></code>.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">stack_spherically</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_037.png" srcset="../../_images/sphx_glr_example_trajectory_tools_037.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="trajectory-func-function">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code><a class="headerlink" href="#trajectory-func-function" title="Link to this heading">#</a></h4>
<p>A function that takes at least one argument <code class="docutils literal notranslate"><span class="pre">Nc</span></code> to control
the number of shots, in order to adapt that value for each stack
and focus more ressources over larger areas. In opposition to
<code class="docutils literal notranslate"><span class="pre">tools.stack</span></code>, it is not possible to use stacked-NUFFT operators
with <code class="docutils literal notranslate"><span class="pre">tools.stack_spherically</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">stack_spherically</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_038.png" srcset="../../_images/sphx_glr_example_trajectory_tools_038.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_039.png" srcset="../../_images/sphx_glr_example_trajectory_tools_039.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/><p>In the previous example, we can observe that spirals and cones
are nicely adapted for each stack, while shrinking the shots
for the radial trajectory is quite irrelevant (coverage is not
improved). Instead, each radial disc could be normalized to
cover a cylinder with variable density over <span class="math notranslate nohighlight">\(k_z\)</span>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_classic</span></a> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">stack_spherically</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">nb_stacks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_normal</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.copy.html#numpy.copy" title="numpy.copy" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">copy</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_classic</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_normal</span></a><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">KMAX</span></a>
    <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_normal</span></a><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.max.html#numpy.max" title="numpy.max" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">max</span></a><span class="p">(</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.norm.html#numpy.linalg.norm" title="numpy.linalg.norm" class="sphx-glr-backref-module-numpy-linalg sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_classic</span></a><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectories</span></a> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Classic&quot;</span><span class="p">:</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_classic</span></a><span class="p">,</span> <span class="s2">&quot;Normalized&quot;</span><span class="p">:</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">traj_normal</span></a><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Classic&quot;</span><span class="p">,</span> <span class="s2">&quot;Normalized&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_040.png" srcset="../../_images/sphx_glr_example_trajectory_tools_040.png" alt="Classic, Normalized" class = "sphx-glr-single-img"/></section>
</section>
<section id="shellify">
<h3>Shellify<a class="headerlink" href="#shellify" title="Link to this heading">#</a></h3>
<p>A tool to carve trajectories into half-spheres/domes and duplicate
them into concentric shells composed of a variable number
of shots depending on their size.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code>: trajectory function that
should return an array-like with the usual <span class="math notranslate nohighlight">\((N_c, N_s, N_d)\)</span> size.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nc</span> <span class="pre">(int)</span></code>: number of shots to use for the whole spherically
stacked trajectory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb_shells</span> <span class="pre">(int)</span></code>: number of shells repeating <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>
with spherical distortion over the <span class="math notranslate nohighlight">\(k_z\)</span>-axis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">z_tilt</span> <span class="pre">(float)</span></code>: angle tilt between concentric shells
around the <span class="math notranslate nohighlight">\(k_z\)</span>-axis. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">None)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hemisphere_mode</span> <span class="pre">(str)</span></code>: define how the lower hemisphere should
be oriented relatively to the upper one, with symmetric providing
a kx-ky planar symmetry by changing the polar angle, and with
reversed promoting continuity (for example in spirals) by
reversing the azimuthal angle. <code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">&quot;symmetric&quot;)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>: trajectory initialization parameters for the
function provided with <code class="docutils literal notranslate"><span class="pre">trajectory_func</span></code>.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">shellify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a>
<span class="p">)</span>
<span class="n">show_trajectory</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trajectory</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">figure_size</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_041.png" srcset="../../_images/sphx_glr_example_trajectory_tools_041.png" alt="example trajectory tools" class = "sphx-glr-single-img"/><section id="id9">
<h4><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code><a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>A function that takes at least one argument <code class="docutils literal notranslate"><span class="pre">Nc</span></code> to control
the number of shots, in order to adapt that value for each shell
and focus more ressources over larger spheres.</p>
<p>Gradient amplitudes and slew rates are likely to be increased
near the edges, and it should be accounted for.
Companion functions will be added in the future in order
to manipulate individual spheres.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Radial&quot;</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Cones&quot;</span><span class="p">,</span> <span class="s2">&quot;3D Cones&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">shellify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_trajectories</span></a><span class="p">[</span><span class="n">x</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span> <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_042.png" srcset="../../_images/sphx_glr_example_trajectory_tools_042.png" alt="Radial, Spiral, 2D Cones, 3D Cones" class = "sphx-glr-single-img"/></section>
<section id="hemisphere-mode-str">
<h4><code class="docutils literal notranslate"><span class="pre">hemisphere_mode</span> <span class="pre">(str)</span></code><a class="headerlink" href="#hemisphere-mode-str" title="Link to this heading">#</a></h4>
<p>Define how the lower hemisphere should be oriented relatively
to the upper one, with symmetric providing a <span class="math notranslate nohighlight">\(k_x-k_y\)</span>
planar symmetry by changing the polar angle, and with reversed
promoting continuity (for example in spirals) by reversing
the azimuthal angle.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;symmetric&quot;</span><span class="p">,</span> <span class="s2">&quot;reversed&quot;</span><span class="p">]</span>
<span class="n">function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tools</span><span class="o">.</span><span class="n">shellify</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_trajectories</span></a><span class="p">[</span><span class="s2">&quot;Spiral&quot;</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nc</span></a><span class="p">,</span> <span class="n">nb_shells</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nb_repetitions</span></a><span class="p">,</span> <span class="n">hemisphere_mode</span><span class="o">=</span><span class="n">x</span>
<span class="p">)</span>
<span class="n">show_argument</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arguments</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one_shot</span></a><span class="p">,</span>
    <span class="n">subfig_size</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subfigure_size</span></a><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_trajectory_tools_043.png" srcset="../../_images/sphx_glr_example_trajectory_tools_043.png" alt="symmetric, reversed" class = "sphx-glr-single-img"/></section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="pip-11" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Pip+11</a><span class="fn-bracket">]</span></span>
<p>Pipe, James G., Nicholas R. Zwart, Eric A. Aboussouan,
Ryan K. Robison, Ajit Devaraj, and Kenneth O. Johnson.
A new design and rationale for 3D orthogonally
oversampled kspace trajectories.
Magnetic resonance in medicine 66, no. 5 (2011): 1303-1311.</p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 29.500 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-autoexamples-example-trajectory-tools-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/mind-inria/mri-nufft/gh-pages?urlpath=lab/tree/examples/generated/autoexamples/example_trajectory_tools.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo1.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/57fe758ad045de81963465e425403cdd/example_trajectory_tools.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_trajectory_tools.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5e603171112a8a016e9782e26639cd0a/example_trajectory_tools.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_trajectory_tools.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/10408bfbfe8d3e76f2be7acbbfc703f9/example_trajectory_tools.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">example_trajectory_tools.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="example_3D_trajectories.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">3D Trajectories</p>
      </div>
    </a>
    <a class="right-next"
       href="GPU/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">GPU Examples</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#script-options">Script options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-tools">Direct tools</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#single-shots">Single shots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#planes">Planes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stack">Stack</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-array"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hard-bounded-bool"><code class="docutils literal notranslate"><span class="pre">hard_bounded</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotate">Rotate</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precess">Precess</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#half-sphere-bool"><code class="docutils literal notranslate"><span class="pre">half_sphere</span> <span class="pre">(bool)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-str"><code class="docutils literal notranslate"><span class="pre">partition</span> <span class="pre">(str)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axis-int-array"><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">(int,</span> <span class="pre">array)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conify">Conify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#max-angle-float"><code class="docutils literal notranslate"><span class="pre">max_angle</span> <span class="pre">(float)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#borderless-bool"><code class="docutils literal notranslate"><span class="pre">borderless</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#epify">Epify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nc-trains-int"><code class="docutils literal notranslate"><span class="pre">Nc_trains</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ns-transitions-int"><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-odd-shots-bool"><code class="docutils literal notranslate"><span class="pre">reverse_odd_shots</span> <span class="pre">(bool)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prewind-rewind">Prewind/rewind</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><code class="docutils literal notranslate"><span class="pre">trajectory</span> <span class="pre">(array)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">Ns_transitions</span> <span class="pre">(int)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-tools">Functional tools</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-spherically">Stack spherically</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-func-function"><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shellify">Shellify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">trajectory_func</span> <span class="pre">(function)</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hemisphere-mode-str"><code class="docutils literal notranslate"><span class="pre">hemisphere_mode</span> <span class="pre">(str)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By MRI-NUFFT Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2022, MRI-NUFFT Contributors.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>